<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador de Volantes</title>
    <link rel="stylesheet" href="assets/css/bootstrap-icons.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            /* Align to the top */
            min-height: 100vh;
        }

        .container {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
            margin: 20px;
        }

        h1 {
            color: #0056b3;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .creado-por {
            text-align: center;
            margin-top: -25px;
            margin-bottom: 30px;
            font-size: 0.9em;
            color: #6c757d;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            gap: 8px;
        }

        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input[type="number"]:focus,
        select:focus {
            border-color: #0056b3;
            box-shadow: 0 0 5px rgba(0, 86, 179, 0.25);
            outline: none;
        }

        .botones-accion {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 25px;
        }

        button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 15px;
            background-color: #0056b3;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover {
            background-color: #004494;
            transform: translateY(-2px);
        }

        .btn-rojo {
            background-color: #dc3545;
        }

        .btn-rojo:hover {
            background-color: #c82333;
        }

        #resultado {
            margin-top: 30px;
        }

        .resumen-precios h2,
        .resumen-precios h3,
        .resumen-precios h4,
        .resumen-precios h5,
        .resumen-detallado h3,
        .resumen-cliente h3 {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .resumen-precios {
            background-color: #e9f5ff;
            padding: 20px;
            border-left: 5px solid #0056b3;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .resumen-precios h2,
        .resumen-precios h3,
        .resumen-precios h4,
        .resumen-precios h5 {
            margin: 5px 0;
            color: #333;
        }

        .resumen-precios h2 {
            font-size: 1.8em;
        }

        .resumen-precios h5 {
            font-weight: 600;
            color: #555;
        }

        #precioFinal {
            font-weight: 700;
            color: #0056b3;
        }

        .resumen-detallado,
        .resumen-cliente {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
        }

        .resumen-detallado h3,
        .resumen-cliente h3 {
            margin-top: 0;
            color: #0056b3;
        }

        .resumen-detallado p {
            white-space: pre-wrap;
            /* Allows line breaks */
            font-family: monospace;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #eee;
        }

        .resumen-cliente pre {
            white-space: pre-wrap;
            font-family: inherit;
            font-size: 1em;
            background: #fff;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #eee;
            line-height: 1.5;
        }

        #copiarPortapapeles {
            width: auto;
            padding: 10px 20px;
            margin-top: 10px;
            font-size: 1em;
            background-color: #28a745;
        }

        #copiarPortapapeles:hover {
            background-color: #218838;
        }

        .advertencia-offset {
            margin-top: 20px;
            padding: 12px 15px;
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
            border-left: 5px solid #ffc107;
            border-radius: 6px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .advertencia-offset .icono-advertencia {
            color: #c82333;
        }

        /* Estilos para el checkbox de Maquila */
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            background-color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-wrapper:hover {
            background-color: #f8f9fa;
            border-color: #dee2e6;
        }

        .checkbox-rojo {
            width: 20px;
            height: 20px;
            accent-color: #dc3545;
            /* Color rojo para el checkbox nativo en navegadores modernos */
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 id="tituloPagina"><i class="bi bi-calculator"></i> Cotizador de Volantes</h1>
        <p class="creado-por">Creado por: Joel Adrian Mtz Meza 8341446103</p>
        <form id="cotizadorForm">

            <!-- TIPO DE TRABAJO -->
            <div class="form-group">
                <label><i class="bi bi-briefcase"></i> Tipo de trabajo:</label>
                <div style="display:flex;gap:12px;">
                    <label style="font-weight:normal;cursor:pointer;display:flex;align-items:center;gap:6px;">
                        <input type="radio" name="tipoTrabajo" id="tipoVolantes" value="volantes" checked
                            onchange="actualizarTipoTrabajo()"> Volantes
                    </label>
                    <label style="font-weight:normal;cursor:pointer;display:flex;align-items:center;gap:6px;">
                        <input type="radio" name="tipoTrabajo" id="tipoImpresiones" value="impresiones"
                            onchange="actualizarTipoTrabajo()"> Impresiones
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="cantidad"><i class="bi bi-stack"></i> <span id="labelCantidad">Cantidad de
                        volantes:</span></label>
                <input type="number" id="cantidad" name="cantidad" min="1" required>
            </div>

            <!-- MODO DE TAMAÑO -->
            <div class="form-group">
                <label><i class="bi bi-rulers"></i> ¿Cómo especificar el tamaño?</label>
                <div style="display:flex;gap:12px;margin-bottom:10px;">
                    <label style="font-weight:normal;cursor:pointer;display:flex;align-items:center;gap:6px;">
                        <input type="radio" name="modoTamano" id="modoPredet" value="predeterminado" checked
                            onchange="actualizarModoTamano()"> Tamaño Predeterminado
                    </label>
                    <label style="font-weight:normal;cursor:pointer;display:flex;align-items:center;gap:6px;">
                        <input type="radio" name="modoTamano" id="modoPersonal" value="personalizado"
                            onchange="actualizarModoTamano()"> Medida Personalizada
                    </label>
                </div>

                <!-- Selector predeterminado -->
                <div id="contenedorTamanoPredet">
                    <select id="tamano" name="tamano">
                        <option value="1/8-carta">1/8 carta (6.98 x 10.79 cm)</option>
                        <option value="1/4-carta">1/4 carta (10.79 x 13.97 cm)</option>
                        <option value="1/3-carta">1/3 carta (9.31 x 21.59 cm)</option>
                        <option value="1/2-carta">1/2 carta (13.97 x 21.59 cm)</option>
                        <option value="carta" selected>Carta (21.59 x 27.94 cm)</option>
                        <option value="doble-carta">Doble Carta (27.94 x 43.18 cm)</option>
                        <option value="1/8-oficio">1/8 oficio (8.50 x 10.79 cm)</option>
                        <option value="1/4-oficio">1/4 oficio (10.79 x 17.00 cm)</option>
                        <option value="1/3-oficio">1/3 oficio (11.33 x 21.59 cm)</option>
                        <option value="1/2-oficio">1/2 oficio (17.00 x 21.59 cm)</option>
                        <option value="oficio">Oficio (21.59 x 34.00 cm)</option>
                        <option value="doble-oficio" disabled>Doble Oficio (solo offset)</option>
                    </select>
                </div>

                <!-- Medida personalizada -->
                <div id="contenedorTamanoPersonal" style="display:none;">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                        <div>
                            <label for="anchoCustom" style="font-weight:600;color:#555;margin-bottom:4px;">Ancho
                                (cm)</label>
                            <input type="number" id="anchoCustom" placeholder="Ej: 10.5" step="0.01" min="0.1">
                        </div>
                        <div>
                            <label for="largoCustom" style="font-weight:600;color:#555;margin-bottom:4px;">Largo
                                (cm)</label>
                            <input type="number" id="largoCustom" placeholder="Ej: 21.0" step="0.01" min="0.1">
                        </div>
                    </div>
                    <p id="tamanoAutoSeleccionado"
                        style="margin-top:8px;font-size:0.88em;color:#0056b3;font-weight:600;"></p>
                </div>
            </div>

            <!-- DETALLES DE IMPRESIÓN -->
            <div class="form-group">
                <label><i class="bi bi-printer-fill"></i> Detalles de Impresión:</label>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                    <!-- FRENTE -->
                    <div style="border:1px solid #b3d4f5;border-radius:8px;padding:12px;background:#f0f7ff;">
                        <div style="font-weight:700;color:#0056b3;margin-bottom:8px;font-size:0.95em;">🖨️ Frente</div>
                        <select id="colorFrente" name="colorFrente" required style="font-size:0.9em;padding:8px;">
                            <option value="blanco-negro">Blanco y Negro</option>
                            <option value="color" selected>Color</option>
                            <option value="1-color">1 Color Específico</option>
                            <option value="2-colores">2 Colores Específicos</option>
                            <option value="3-colores">3 Colores Específicos</option>
                        </select>
                    </div>
                    <!-- REVERSO -->
                    <div style="border:1px solid #d4e8d4;border-radius:8px;padding:12px;background:#f0fff0;">
                        <div style="font-weight:700;color:#27ae60;margin-bottom:8px;font-size:0.95em;">↩️ Reverso</div>
                        <select id="colorReverso" name="colorReverso" style="font-size:0.9em;padding:8px;">
                            <option value="ninguno" selected>No lleva (solo frente)</option>
                            <option value="1-color">1 Color Específico</option>
                            <option value="2-colores">2 Colores Específicos</option>
                            <option value="3-colores">3 Colores Específicos</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="papel"><i class="bi bi-file-earmark-text"></i> Tipo de papel:</label>
                <select id="papel" name="papel" required>
                    <!-- Opciones de papel se agregarán dinámicamente con JavaScript -->
                </select>
            </div>

            <!-- LAMINADO -->
            <div class="form-group">
                <label><i class="bi bi-layers-fill"></i> Laminado:</label>
                <div style="display:flex;gap:12px;margin-bottom:10px;">
                    <label style="font-weight:normal;cursor:pointer;display:flex;align-items:center;gap:6px;">
                        <input type="radio" name="laminado" id="laminadoNo" value="no" checked
                            onchange="actualizarLaminado()"> No lleva
                    </label>
                    <label style="font-weight:normal;cursor:pointer;display:flex;align-items:center;gap:6px;">
                        <input type="radio" name="laminado" id="laminadoSi" value="si" onchange="actualizarLaminado()">
                        Sí lleva
                    </label>
                </div>
                <div id="opcionesLaminado"
                    style="display:none;border:1px solid #d0c4f5;border-radius:8px;padding:12px;background:#faf0ff;">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                        <!-- Frente laminado -->
                        <div>
                            <div style="font-weight:700;color:#6f42c1;margin-bottom:6px;font-size:0.9em;">🖨️ Frente
                            </div>
                            <select id="laminadoFrente" style="font-size:0.9em;padding:8px;">
                                <option value="brillante">Brillante</option>
                                <option value="mate">Mate</option>
                            </select>
                        </div>
                        <!-- Reverso laminado -->
                        <div>
                            <div style="font-weight:700;color:#6f42c1;margin-bottom:6px;font-size:0.9em;">↩️ Reverso
                            </div>
                            <select id="laminadoReverso" style="font-size:0.9em;padding:8px;">
                                <option value="ninguno">Solo 1 lado (sin reverso)</option>
                                <option value="brillante">Brillante</option>
                                <option value="mate">Mate</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="diseno"><i class="bi bi-pencil-tip"></i> Tipo de Diseño:</label>
                <select id="diseno" name="diseno" required>
                    <option value="0">Cliente envia diseño</option>
                    <option value="150">Diseño guardado aqui</option>
                    <option value="250">Realizar diseño</option>
                </select>
            </div>

            <div class="form-group">
                <label class="checkbox-wrapper">
                    <input type="checkbox" id="maquila" name="maquila" class="checkbox-rojo">
                    <span style="font-weight: 600; color: #dc3545;"><i class="bi bi-check-square-fill"></i> Es para
                        maquila (Descuento 18%)</span>
                </label>
            </div>

            <div class="botones-accion">
                <button type="submit"><i class="bi bi-calculator-fill"></i> Cotizar</button>
                <button type="button" id="limpiarCampos" class="btn-rojo"><i class="bi bi-eraser-fill"></i> Limpiar
                    Campos</button>
            </div>
        </form>
        <div id="error-container" class="advertencia-offset" style="display: none;"></div>
        <div id="resultado" style="display: none;">
            <div class="resumen-precios">
                <h3>Subtotal: <span id="subtotal">$0.00</span></h3>
                <h3>IVA (16%): <span id="iva">$0.00</span></h3>
                <h2><i class="bi bi-cash-coin"></i> Total: <span id="precioFinal">$0.00</span></h2>
                <h4>Costo Unitario (Neto): <span id="costoUnitario">$0.00</span></h4>
                <h5>Costo Unitario (sin IVA): <span id="costoUnitarioSinIva">$0.00</span></h5>
            </div>

            <div id="resumenCostos" class="resumen-detallado">
                <h3><i class="bi bi-card-list"></i> Resumen de Costos (Detallado)</h3>
                <p id="resumenCostosTexto"></p>
            </div>

            <div id="resumenSimplificado" class="resumen-cliente">
                <h3><i class="bi bi-send"></i> Resumen para Cliente</h3>
                <pre id="resumenSimplificadoTexto"></pre>
                <button type="button" id="copiarPortapapeles"><i class="bi bi-clipboard-check"></i> Copiar al
                    Portapapeles</button>
            </div>
            <div id="advertenciaOffset" class="advertencia-offset" style="display: none;"></div>
        </div>

        <!-- SECCIÓN CONSULTA DE COSTOS -->
        <div class="seccion-costos-maestro" style="margin-top:30px;">
            <div class="costos-header" onclick="toggleSeccionCostos()"
                style="display:flex;justify-content:space-between;align-items:center;cursor:pointer;background:#e9f5ff;border:1px solid #b3d4f5;border-radius:8px;padding:14px 18px;">
                <span style="font-weight:700;color:#0056b3;font-size:1.05em;"><i class="bi bi-table"></i> Consulta de
                    Costos</span>
                <span id="iconoCostos" style="font-size:1.4em;font-weight:700;color:#0056b3;">+</span>
            </div>
            <div id="contenidoCostos"
                style="display:none;border:1px solid #b3d4f5;border-top:none;border-radius:0 0 8px 8px;padding:16px;background:#f8fbff;">

                <!-- Papel -->
                <details style="margin-bottom:10px;">
                    <summary style="font-weight:700;color:#e67e22;cursor:pointer;padding:8px 0;">📄 Papel (costo por
                        pliego)</summary>
                    <div id="costosPapelDetalle" style="padding:8px 0 0 12px;font-size:0.9em;"></div>
                </details>

                <!-- Impresión -->
                <details style="margin-bottom:10px;">
                    <summary style="font-weight:700;color:#0056b3;cursor:pointer;padding:8px 0;">🖨️ Costos de Impresión
                        (por hoja base)</summary>
                    <div id="costosImpresionDetalle" style="padding:8px 0 0 12px;font-size:0.9em;"></div>
                </details>

                <!-- Laminado -->
                <details style="margin-bottom:10px;">
                    <summary style="font-weight:700;color:#6f42c1;cursor:pointer;padding:8px 0;">✨ Laminado (costo por
                        pieza)</summary>
                    <div style="padding:8px 0 0 12px;font-size:0.88em;overflow-x:auto;">
                        <p style="margin:0 0 6px;color:#555;">Mínimo de cobro: <b>$250.00</b> aunque el cálculo sea
                            menor.</p>
                        <table style="border-collapse:collapse;width:100%;">
                            <thead>
                                <tr style="background:#e8d5ff;">
                                    <th style="border:1px solid #ccc;padding:4px 6px;text-align:left;">Rango</th>
                                    <th style="border:1px solid #ccc;padding:4px 6px;">Carta</th>
                                    <th style="border:1px solid #ccc;padding:4px 6px;">Oficio</th>
                                    <th style="border:1px solid #ccc;padding:4px 6px;">Doble Carta</th>
                                </tr>
                            </thead>
                            <tbody id="tablaLaminadoBrillante"></tbody>
                        </table>
                        <p style="margin:8px 0 4px;font-weight:700;color:#6f42c1;">Mate:</p>
                        <table style="border-collapse:collapse;width:100%;">
                            <thead>
                                <tr style="background:#e8d5ff;">
                                    <th style="border:1px solid #ccc;padding:4px 6px;text-align:left;">Rango</th>
                                    <th style="border:1px solid #ccc;padding:4px 6px;">Carta</th>
                                    <th style="border:1px solid #ccc;padding:4px 6px;">Oficio</th>
                                    <th style="border:1px solid #ccc;padding:4px 6px;">Doble Carta</th>
                                </tr>
                            </thead>
                            <tbody id="tablaLaminadoMate"></tbody>
                        </table>
                    </div>
                </details>

                <!-- Diseño -->
                <details style="margin-bottom:10px;">
                    <summary style="font-weight:700;color:#27ae60;cursor:pointer;padding:8px 0;">🎨 Diseño</summary>
                    <div style="padding:8px 0 0 12px;font-size:0.9em;">
                        <p style="margin:3px 0;">Cliente envía diseño: <b>$0.00</b></p>
                        <p style="margin:3px 0;">Diseño guardado aquí: <b>$150.00</b></p>
                        <p style="margin:3px 0;">Realizar diseño nuevo: <b>$250.00</b></p>
                    </div>
                </details>

                <!-- Descuento Maquila -->
                <details style="margin-bottom:10px;">
                    <summary style="font-weight:700;color:#dc3545;cursor:pointer;padding:8px 0;">🏭 Descuento Maquila
                    </summary>
                    <div style="padding:8px 0 0 12px;font-size:0.9em;">
                        <p style="margin:3px 0;">Descuento del <b>18%</b> sobre el subtotal (Papel + Impresión + Corte +
                            Diseño)</p>
                    </div>
                </details>

                <!-- Otros -->
                <details>
                    <summary style="font-weight:700;color:#6c757d;cursor:pointer;padding:8px 0;">⚙️ Otros Costos
                    </summary>
                    <div style="padding:8px 0 0 12px;font-size:0.9em;">
                        <p style="margin:3px 0;">Costo por bajada de guillotina: <b>$25.00</b></p>
                        <p style="margin:3px 0;">Bajadas para 1/8: <b>8</b> | 1/4: <b>7</b> | 1/3: <b>6</b> | 1/2:
                            <b>5</b>
                        </p>
                        <p style="margin:3px 0;">IVA: <b>16%</b></p>
                    </div>
                </details>
            </div>
        </div>

    </div>
    <script>
        // ---- DATOS DE COSTOS ----
        const costosPapel = {
            'carta': {
                'papel-opalina-blanca-120gr': { costo: 3.80, porPliego: 8, cortePorHojas: 200 },
                'cartulina-opalina-blanca-225gr': { costo: 7.34, porPliego: 8, cortePorHojas: 100 },
                'cartulina-opalina-crema-225gr': { costo: 6.20, porPliego: 8, cortePorHojas: 100 },
                'papel-bond-75gr': { costo: 1.56, porPliego: 8, cortePorHojas: 500 },
                'papel-bond-90gr': { costo: 1.60, porPliego: 8, cortePorHojas: 500 },
                'papel-couche-130gr': { costo: 2.31, porPliego: 8, cortePorHojas: 500 },
                'papel-couche-150gr': { costo: 2.95, porPliego: 8, cortePorHojas: 250 },
                'cartulina-couche-200gr': { costo: 3.42, porPliego: 8, cortePorHojas: 250 },
                'cartulina-couche-250gr': { costo: 4.51, porPliego: 8, cortePorHojas: 250 },
                'cartulina-couche-300gr': { costo: 5.40, porPliego: 8, cortePorHojas: 125 },
            },
            'oficio': {
                'papel-opalina-blanca-120gr': { costo: 5.07, porPliego: 8, cortePorHojas: 200 },
                'papel-bond-75gr': { costo: 1.63, porPliego: 8, cortePorHojas: 500 },
                'papel-bond-90gr': { costo: 1.95, porPliego: 8, cortePorHojas: 500 },
                'papel-couche-130gr': { costo: 3.26, porPliego: 8, cortePorHojas: 250 },
                'papel-couche-150gr': { costo: 3.50, porPliego: 8, cortePorHojas: 250 },
                'cartulina-couche-200gr': { costo: 4.91, porPliego: 8, cortePorHojas: 125 },
                'cartulina-couche-250gr': { costo: 6.23, porPliego: 8, cortePorHojas: 125 },
                'cartulina-couche-300gr': { costo: 7.37, porPliego: 8, cortePorHojas: 125 },
            }
        };

        const costosImpresion = {
            'color': {
                'carta': [{ max: 100, costo: 6.08 }, { max: 200, costo: 6.00 }, { max: 300, costo: 5.85 }, { max: 500, costo: 5.70 }, { max: Infinity, costo: 5.70 }],
                'doble-carta': [{ max: 100, costo: 12.16 }, { max: 200, costo: 12.00 }, { max: 300, costo: 11.70 }, { max: 500, costo: 11.40 }, { max: Infinity, costo: 11.40 }],
                'oficio': [{ max: 100, costo: 6.50 }, { max: 200, costo: 6.08 }, { max: 300, costo: 5.90 }, { max: 500, costo: 5.70 }, { max: Infinity, costo: 5.70 }],
                'doble-oficio': [{ max: 100, costo: 13.00 }, { max: 200, costo: 12.16 }, { max: 300, costo: 11.80 }, { max: 500, costo: 11.40 }, { max: Infinity, costo: 11.40 }]
            },
            'blanco-negro': {
                'carta': [{ max: 100, costo: 1.06 }, { max: 200, costo: 1.00 }, { max: 300, costo: 0.98 }, { max: 500, costo: 0.80 }, { max: Infinity, costo: 0.78 }],
                'doble-carta': [{ max: 100, costo: 2.12 }, { max: 200, costo: 2.00 }, { max: 300, costo: 1.96 }, { max: 500, costo: 1.60 }, { max: Infinity, costo: 1.56 }],
                'oficio': [{ max: 100, costo: 1.20 }, { max: 200, costo: 1.05 }, { max: 300, costo: 0.98 }, { max: 500, costo: 0.80 }, { max: Infinity, costo: 0.78 }],
                'doble-oficio': [{ max: 100, costo: 2.40 }, { max: 200, costo: 2.10 }, { max: 300, costo: 1.96 }, { max: 500, costo: 1.60 }, { max: Infinity, costo: 1.56 }]
            }
        };
        costosImpresion['1-color'] = costosImpresion['color'];
        costosImpresion['2-colores'] = costosImpresion['color'];
        costosImpresion['3-colores'] = costosImpresion['color'];

        // ---- COSTOS DE LAMINADO (por pieza) ----
        const costosLaminado = {
            'brillante': {
                'carta': [{ min: 1, max: 50, costo: 4.00 }, { min: 51, max: 100, costo: 3.80 }, { min: 101, max: 150, costo: 3.50 }, { min: 151, max: 200, costo: 3.30 }, { min: 201, max: 500, costo: 3.00 }, { min: 501, max: Infinity, costo: 2.80 }],
                'oficio': [{ min: 1, max: 50, costo: 5.40 }, { min: 51, max: 100, costo: 5.13 }, { min: 101, max: 150, costo: 4.725 }, { min: 151, max: 200, costo: 4.455 }, { min: 201, max: 500, costo: 4.05 }, { min: 501, max: Infinity, costo: 3.78 }],
                'doble-carta': [{ min: 1, max: 50, costo: 8.00 }, { min: 51, max: 100, costo: 7.60 }, { min: 101, max: 150, costo: 7.00 }, { min: 151, max: 200, costo: 6.60 }, { min: 201, max: 500, costo: 6.00 }, { min: 501, max: Infinity, costo: 5.60 }]
            },
            'mate': {
                'carta': [{ min: 1, max: 50, costo: 4.60 }, { min: 51, max: 100, costo: 4.37 }, { min: 101, max: 150, costo: 4.025 }, { min: 151, max: 200, costo: 3.795 }, { min: 201, max: 500, costo: 3.45 }, { min: 501, max: Infinity, costo: 3.22 }],
                'oficio': [{ min: 1, max: 50, costo: 6.21 }, { min: 51, max: 100, costo: 5.8995 }, { min: 101, max: 150, costo: 5.43375 }, { min: 151, max: 200, costo: 5.12325 }, { min: 201, max: 500, costo: 4.6575 }, { min: 501, max: Infinity, costo: 4.347 }],
                'doble-carta': [{ min: 1, max: 50, costo: 9.20 }, { min: 51, max: 100, costo: 8.74 }, { min: 101, max: 150, costo: 8.05 }, { min: 151, max: 200, costo: 7.59 }, { min: 201, max: 500, costo: 6.90 }, { min: 501, max: Infinity, costo: 6.44 }]
            }
        };
        const LAMINADO_MINIMO = 250;

        // Medidas reales de cada tamano predeterminado (ancho x largo en cm)
        const medidasTamanos = {
            '1/8-carta': { ancho: 6.98, largo: 10.79, base: 'carta', divisor: 8 },
            '1/4-carta': { ancho: 10.79, largo: 13.97, base: 'carta', divisor: 4 },
            '1/3-carta': { ancho: 9.31, largo: 21.59, base: 'carta', divisor: 3 },
            '1/2-carta': { ancho: 13.97, largo: 21.59, base: 'carta', divisor: 2 },
            'carta': { ancho: 21.59, largo: 27.94, base: 'carta', divisor: 1 },
            'doble-carta': { ancho: 27.94, largo: 43.18, base: 'doble-carta', divisor: 0.5 },
            '1/8-oficio': { ancho: 8.50, largo: 10.79, base: 'oficio', divisor: 8 },
            '1/4-oficio': { ancho: 10.79, largo: 17.00, base: 'oficio', divisor: 4 },
            '1/3-oficio': { ancho: 11.33, largo: 21.59, base: 'oficio', divisor: 3 },
            '1/2-oficio': { ancho: 17.00, largo: 21.59, base: 'oficio', divisor: 2 },
            'oficio': { ancho: 21.59, largo: 34.00, base: 'oficio', divisor: 1 },
        };

        const bajadasCorte = { '1/8': 8, '1/4': 7, '1/3': 6, '1/2': 5 };
        const costoPorBajada = 25;
        const IVA_RATE = 0.16;

        function formatCurrency(value) { return '$' + value.toFixed(2); }

        // ---- TIPO DE TRABAJO ----
        function actualizarTipoTrabajo() {
            const tipo = document.querySelector('input[name="tipoTrabajo"]:checked').value;
            document.getElementById('tituloPagina').innerHTML =
                tipo === 'volantes'
                    ? '<i class="bi bi-calculator"></i> Cotizador de Volantes'
                    : '<i class="bi bi-printer"></i> Cotizador de Impresiones';
            document.getElementById('labelCantidad').textContent =
                tipo === 'volantes' ? 'Cantidad de volantes:' : 'Cantidad de impresiones:';
        }

        // ---- MODO TAMANO ----
        function actualizarModoTamano() {
            const modo = document.querySelector('input[name="modoTamano"]:checked').value;
            document.getElementById('contenedorTamanoPredet').style.display = modo === 'predeterminado' ? '' : 'none';
            document.getElementById('contenedorTamanoPersonal').style.display = modo === 'personalizado' ? '' : 'none';
        }

        // ---- LAMINADO ----
        function actualizarLaminado() {
            const lleva = document.querySelector('input[name="laminado"]:checked').value === 'si';
            document.getElementById('opcionesLaminado').style.display = lleva ? '' : 'none';
        }

        // Detecta el tamano predeterminado mas pequeno que contenga la medida personalizada
        function resolverTamanoDesdeCustom(anchoCm, largoCm) {
            const orden = ['1/8-carta', '1/8-oficio', '1/4-carta', '1/4-oficio', '1/3-carta', '1/3-oficio',
                '1/2-carta', '1/2-oficio', 'carta', 'oficio', 'doble-carta'];
            for (const key of orden) {
                const m = medidasTamanos[key];
                if ((anchoCm <= m.ancho && largoCm <= m.largo) || (largoCm <= m.ancho && anchoCm <= m.largo)) return key;
            }
            return 'doble-carta';
        }

        // ---- ACTUALIZAR PAPEL SEGUN TAMANO ----
        function actualizarOpcionesPapel(tamanoKey) {
            const papelSelect = document.getElementById('papel');
            const tipoPliego = tamanoKey.includes('oficio') ? 'oficio' : 'carta';
            const opciones = costosPapel[tipoPliego];
            papelSelect.innerHTML = '';
            for (const key in opciones) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = key.replace(/-/g, ' ').replace(/\b\w/g, function (l) { return l.toUpperCase(); });
                papelSelect.appendChild(option);
            }
        }

        // Obtiene costo de laminado por pieza segun tipo, tamano base y cantidad
        function getCostoLaminado(tipo, tamanoBase, cantidad) {
            var tamLam = 'carta';
            if (tamanoBase === 'doble-carta') tamLam = 'doble-carta';
            else if (tamanoBase === 'oficio' || tamanoBase === 'doble-oficio') tamLam = 'oficio';
            const rangos = costosLaminado[tipo][tamLam];
            for (const r of rangos) {
                if (cantidad >= r.min && cantidad <= r.max) return r.costo;
            }
            return rangos[rangos.length - 1].costo;
        }

        // ---- TOGGLE CONSULTA DE COSTOS ----
        function toggleSeccionCostos() {
            const contenido = document.getElementById('contenidoCostos');
            const icono = document.getElementById('iconoCostos');
            const abierto = contenido.style.display !== 'none';
            contenido.style.display = abierto ? 'none' : 'block';
            icono.textContent = abierto ? '+' : '-';
            if (!abierto) renderizarConsultaCostos();
        }

        function renderizarConsultaCostos() {
            // Papel
            var htmlPapel = '';
            for (const tipo of ['carta', 'oficio']) {
                htmlPapel += '<b style="color:#0056b3">' + tipo.charAt(0).toUpperCase() + tipo.slice(1) + ':</b><br>';
                for (const [key, val] of Object.entries(costosPapel[tipo])) {
                    const nombre = key.replace(/-/g, ' ').replace(/\b\w/g, function (l) { return l.toUpperCase(); });
                    htmlPapel += '&nbsp;&nbsp;' + nombre + ': <b>' + formatCurrency(val.costo) + '</b>/pliego (' + val.porPliego + ' hojas/pliego)<br>';
                }
                htmlPapel += '<br>';
            }
            document.getElementById('costosPapelDetalle').innerHTML = htmlPapel;

            // Impresion - tabla por tamano
            const tamanos = ['carta', 'doble-carta', 'oficio', 'doble-oficio'];
            var htmlImp = '';
            const grupos = [['Color', costosImpresion['color']], ['Blanco y Negro', costosImpresion['blanco-negro']]];
            for (const [colorKey, data] of grupos) {
                htmlImp += '<b style="color:#0056b3">' + colorKey + ':</b><br>';
                htmlImp += '<table style="border-collapse:collapse;width:100%;margin-bottom:10px;font-size:0.88em;">';
                htmlImp += '<thead><tr style="background:#ddeeff;">';
                htmlImp += '<th style="border:1px solid #ccc;padding:3px 6px;text-align:left;">Hojas</th>';
                htmlImp += '<th style="border:1px solid #ccc;padding:3px 6px;">Carta</th>';
                htmlImp += '<th style="border:1px solid #ccc;padding:3px 6px;">Doble Carta</th>';
                htmlImp += '<th style="border:1px solid #ccc;padding:3px 6px;">Oficio</th>';
                htmlImp += '<th style="border:1px solid #ccc;padding:3px 6px;">Doble Oficio</th>';
                htmlImp += '</tr></thead><tbody>';
                const rangosRef = data['carta'];
                for (var i = 0; i < rangosRef.length; i++) {
                    const r = rangosRef[i];
                    var desde = i === 0 ? 1 : (rangosRef[i - 1].max + 1);
                    var etiq = r.max === Infinity ? (desde + '+') : (desde + '-' + r.max);
                    htmlImp += '<tr style="background:' + (i % 2 === 0 ? '#fff' : '#f5f9ff') + ';">';
                    htmlImp += '<td style="border:1px solid #ccc;padding:3px 6px;">' + etiq + '</td>';
                    for (const tam of tamanos) {
                        var costo = (data[tam] && data[tam][i]) ? data[tam][i].costo : null;
                        htmlImp += '<td style="border:1px solid #ccc;padding:3px 6px;text-align:center;"><b>' + (costo !== null ? formatCurrency(costo) : '-') + '</b></td>';
                    }
                    htmlImp += '</tr>';
                }
                htmlImp += '</tbody></table>';
            }
            document.getElementById('costosImpresionDetalle').innerHTML = htmlImp;

            // Laminado - tablas
            for (const tipo of ['brillante', 'mate']) {
                const tbodyId = tipo === 'brillante' ? 'tablaLaminadoBrillante' : 'tablaLaminadoMate';
                const tbody = document.getElementById(tbodyId);
                if (!tbody) continue;
                const data = costosLaminado[tipo];
                var html = '';
                html += '<tr style="background:#d8c4f5;"><td colspan="4" style="border:1px solid #ccc;padding:3px 6px;font-weight:700;color:#6f42c1;">' + tipo.charAt(0).toUpperCase() + tipo.slice(1) + '</td></tr>';
                for (var j = 0; j < data['carta'].length; j++) {
                    const r = data['carta'][j];
                    var etiq2 = r.max === Infinity ? (r.min + '+') : (r.min + '-' + r.max);
                    html += '<tr style="background:' + (j % 2 === 0 ? '#fff' : '#f8f0ff') + ';">';
                    html += '<td style="border:1px solid #ccc;padding:3px 6px;">' + etiq2 + ' pz</td>';
                    html += '<td style="border:1px solid #ccc;padding:3px 6px;text-align:center;"><b>' + formatCurrency(data['carta'][j].costo) + '</b></td>';
                    html += '<td style="border:1px solid #ccc;padding:3px 6px;text-align:center;"><b>' + formatCurrency(data['oficio'][j].costo) + '</b></td>';
                    html += '<td style="border:1px solid #ccc;padding:3px 6px;text-align:center;"><b>' + formatCurrency(data['doble-carta'][j].costo) + '</b></td>';
                    html += '</tr>';
                }
                tbody.innerHTML = html;
            }
        }

        // ---- CALCULO PRINCIPAL ----
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('cotizadorForm');
            const tamanoSelect = document.getElementById('tamano');
            const papelSelect = document.getElementById('papel');
            const cantidadInput = document.getElementById('cantidad');
            const resultadoDiv = document.getElementById('resultado');
            const subtotalSpan = document.getElementById('subtotal');
            const ivaSpan = document.getElementById('iva');
            const precioFinalSpan = document.getElementById('precioFinal');
            const costoUnitarioSpan = document.getElementById('costoUnitario');
            const costoUnitarioSinIvaSpan = document.getElementById('costoUnitarioSinIva');
            const resumenCostosTextoP = document.getElementById('resumenCostosTexto');
            const resumenSimplificadoTextoPre = document.getElementById('resumenSimplificadoTexto');
            const advertenciaOffsetDiv = document.getElementById('advertenciaOffset');
            const limpiarCamposBtn = document.getElementById('limpiarCampos');
            const copiarPortapapelesBtn = document.getElementById('copiarPortapapeles');

            function calcularCosto() {
                const cantidad = parseInt(cantidadInput.value);
                const colorFrente = document.getElementById('colorFrente').value;
                const colorReverso = document.getElementById('colorReverso').value;
                const papelKey = papelSelect.value;
                const papelNombre = papelSelect.options[papelSelect.selectedIndex].text;
                const disenoSelect = document.getElementById('diseno');
                const costoDiseno = parseFloat(disenoSelect.value);
                const disenoNombre = disenoSelect.options[disenoSelect.selectedIndex].text;
                const errorDiv = document.getElementById('error-container');
                errorDiv.style.display = 'none';

                // Determinar tamano y medidas
                const modo = document.querySelector('input[name="modoTamano"]:checked').value;
                var tamano, medidaTexto;

                if (modo === 'personalizado') {
                    const ancho = parseFloat(document.getElementById('anchoCustom').value);
                    const largo = parseFloat(document.getElementById('largoCustom').value);
                    if (!ancho || !largo || ancho <= 0 || largo <= 0) {
                        errorDiv.innerHTML = '<span class="icono-advertencia"><i class="bi bi-exclamation-triangle-fill"></i></span> Por favor ingresa el ancho y largo en cm.';
                        errorDiv.style.display = 'block';
                        resultadoDiv.style.display = 'none';
                        return;
                    }
                    tamano = resolverTamanoDesdeCustom(ancho, largo);
                    medidaTexto = ancho + ' x ' + largo + ' cm (papel: ' + tamano.replace(/-/g, ' ') + ')';
                    document.getElementById('tamanoAutoSeleccionado').textContent =
                        'Papel seleccionado automaticamente: ' + tamano.replace(/-/g, ' ') + ' (' + medidasTamanos[tamano].ancho + ' x ' + medidasTamanos[tamano].largo + ' cm)';
                } else {
                    tamano = tamanoSelect.value;
                    const m = medidasTamanos[tamano];
                    medidaTexto = m ? (tamano.replace(/-/g, ' ') + ' (' + m.ancho + ' x ' + m.largo + ' cm)') : tamano.replace(/-/g, ' ');
                }

                if (!cantidad || cantidad < 1 || !tamano || !colorFrente || !papelKey) {
                    errorDiv.innerHTML = '<span class="icono-advertencia"><i class="bi bi-exclamation-triangle-fill"></i></span> Por favor, complete todos los campos requeridos.';
                    errorDiv.style.display = 'block';
                    resultadoDiv.style.display = 'none';
                    return;
                }

                var resumenDetallado = 'Calculo Detallado:\n\n';

                // 1. Papel
                const tipoPliego = tamano.includes('oficio') ? 'oficio' : 'carta';
                const papelData = costosPapel[tipoPliego][papelKey];
                const costoPorHojaBase = (papelData.costo / papelData.porPliego) * 2;
                var divisorTamano = 1;
                if (tamano.includes('doble')) divisorTamano = 0.5;
                else if (tamano.includes('1/2')) divisorTamano = 2;
                else if (tamano.includes('1/3')) divisorTamano = 3;
                else if (tamano.includes('1/4')) divisorTamano = 4;
                else if (tamano.includes('1/8')) divisorTamano = 8;

                const hojasBaseNecesarias = Math.ceil(cantidad / divisorTamano);
                const costoTotalPapel = costoPorHojaBase * hojasBaseNecesarias;

                resumenDetallado += '1. Papel (' + papelNombre + ') [' + tipoPliego + ']:\n';
                resumenDetallado += '   Pliego: ' + formatCurrency(papelData.costo) + ' | Costo/hoja base: ' + formatCurrency(costoPorHojaBase) + '\n';
                resumenDetallado += '   Hojas necesarias: CEIL(' + cantidad + '/' + divisorTamano + ') = ' + hojasBaseNecesarias + '\n';
                resumenDetallado += '   Total papel: ' + formatCurrency(costoTotalPapel) + '\n\n';

                // 2. Impresion Frente
                var tamanoBaseImpresion;
                if (tamano.includes('doble-carta')) tamanoBaseImpresion = 'doble-carta';
                else if (tamano.includes('carta')) tamanoBaseImpresion = 'carta';
                else if (tamano.includes('doble-oficio')) tamanoBaseImpresion = 'doble-oficio';
                else tamanoBaseImpresion = 'oficio';

                const rangosFrente = costosImpresion[colorFrente][tamanoBaseImpresion];
                var costoImpFrente = rangosFrente[rangosFrente.length - 1].costo;
                for (const r of rangosFrente) { if (hojasBaseNecesarias <= r.max) { costoImpFrente = r.costo; break; } }
                const totalImpFrente = costoImpFrente * hojasBaseNecesarias;

                resumenDetallado += '2. Impresion Frente (' + colorFrente.replace(/-/g, ' ') + '):\n';
                resumenDetallado += '   ' + formatCurrency(costoImpFrente) + '/hoja x ' + hojasBaseNecesarias + ' hojas = ' + formatCurrency(totalImpFrente) + '\n\n';

                // 3. Impresion Reverso
                var totalImpReverso = 0;
                var costoImpReverso = 0;
                if (colorReverso !== 'ninguno') {
                    const rangosReverso = costosImpresion[colorReverso][tamanoBaseImpresion];
                    costoImpReverso = rangosReverso[rangosReverso.length - 1].costo;
                    for (const r of rangosReverso) { if (hojasBaseNecesarias <= r.max) { costoImpReverso = r.costo; break; } }
                    totalImpReverso = costoImpReverso * hojasBaseNecesarias;
                    resumenDetallado += '3. Impresion Reverso (' + colorReverso.replace(/-/g, ' ') + '):\n';
                    resumenDetallado += '   ' + formatCurrency(costoImpReverso) + '/hoja x ' + hojasBaseNecesarias + ' hojas = ' + formatCurrency(totalImpReverso) + '\n\n';
                } else {
                    resumenDetallado += '3. Impresion Reverso: No lleva (solo frente)\n\n';
                }
                const costoTotalImpresion = totalImpFrente + totalImpReverso;

                // 4. Corte
                var costoTotalCorte = 0;
                const tamanoFraccion = Object.keys(bajadasCorte).find(function (f) { return tamano.includes(f); });
                if (tamanoFraccion) {
                    const numBajadas = bajadasCorte[tamanoFraccion];
                    const gruposDeCorte = Math.ceil(hojasBaseNecesarias / papelData.cortePorHojas);
                    costoTotalCorte = numBajadas * costoPorBajada * gruposDeCorte;
                    resumenDetallado += '4. Corte: ' + numBajadas + ' bajadas x $' + costoPorBajada + ' x ' + gruposDeCorte + ' grupo(s) = ' + formatCurrency(costoTotalCorte) + '\n\n';
                } else {
                    resumenDetallado += '4. Corte: $0.00 (No aplica)\n\n';
                }

                // 5. Laminado
                var costoTotalLaminado = 0;
                var textoLaminado = 'Sin laminado';
                const llevaLaminado = document.querySelector('input[name="laminado"]:checked').value === 'si';
                if (llevaLaminado) {
                    const tipoFrente = document.getElementById('laminadoFrente').value;
                    const tipoReverso = document.getElementById('laminadoReverso').value;
                    const costoLamFrentePorPieza = getCostoLaminado(tipoFrente, tamanoBaseImpresion, cantidad);
                    var costoLamReverso = 0;
                    var textoReversoLam = 'sin reverso';
                    if (tipoReverso !== 'ninguno') {
                        costoLamReverso = getCostoLaminado(tipoReverso, tamanoBaseImpresion, cantidad);
                        textoReversoLam = 'Reverso ' + tipoReverso + ' ' + formatCurrency(costoLamReverso) + '/pz';
                    }
                    const costoLamCalculado = (costoLamFrentePorPieza + costoLamReverso) * cantidad;
                    costoTotalLaminado = Math.max(costoLamCalculado, LAMINADO_MINIMO);
                    textoLaminado = 'Frente ' + tipoFrente + ' (' + formatCurrency(costoLamFrentePorPieza) + '/pz)' + (tipoReverso !== 'ninguno' ? ', Reverso ' + tipoReverso + ' (' + formatCurrency(costoLamReverso) + '/pz)' : ', sin reverso');
                    resumenDetallado += '5. Laminado (' + textoLaminado + '):\n';
                    resumenDetallado += '   Calculado: ' + formatCurrency(costoLamCalculado) + ' | Minimo: $' + LAMINADO_MINIMO + '\n';
                    resumenDetallado += '   Total laminado: ' + formatCurrency(costoTotalLaminado) + '\n\n';
                } else {
                    resumenDetallado += '5. Laminado: Sin laminado\n\n';
                }

                // 6. Diseno
                resumenDetallado += '6. Diseno (' + disenoNombre + '): ' + formatCurrency(costoDiseno) + '\n\n';

                // 7. Totales
                var subtotal = costoTotalPapel + costoTotalImpresion + costoTotalCorte + costoTotalLaminado + costoDiseno;
                var descuentoMaquila = 0;
                const esMaquila = document.getElementById('maquila').checked;
                if (esMaquila) {
                    descuentoMaquila = subtotal * 0.18;
                    subtotal -= descuentoMaquila;
                    resumenDetallado += '<span style="color:red;font-weight:bold;">Descuento Maquila (18%): -' + formatCurrency(descuentoMaquila) + '</span>\n';
                }

                const iva = subtotal * IVA_RATE;
                const total = Math.ceil(subtotal + iva);
                const costoUnitario = total / cantidad;
                const costoUnitarioSinIva = subtotal / cantidad;

                resumenDetallado += '7. Totalizacion:\n';
                resumenDetallado += '   Subtotal: ' + formatCurrency(subtotal) + '\n';
                resumenDetallado += '   IVA (16%): ' + formatCurrency(iva) + '\n';
                resumenDetallado += '   Total: ' + formatCurrency(total) + '\n';
                resumenDetallado += '   Costo Unitario: ' + formatCurrency(costoUnitario) + '\n';

                // Mostrar resultados
                resultadoDiv.style.display = 'block';
                subtotalSpan.textContent = formatCurrency(subtotal);
                ivaSpan.textContent = formatCurrency(iva);
                precioFinalSpan.textContent = formatCurrency(total);
                costoUnitarioSpan.textContent = formatCurrency(costoUnitario);
                costoUnitarioSinIvaSpan.textContent = formatCurrency(costoUnitarioSinIva);
                resumenCostosTextoP.innerHTML = resumenDetallado.replace(/\n/g, '<br>');

                // Resumen para cliente
                const tipoTrabajo = document.querySelector('input[name="tipoTrabajo"]:checked').value;
                const palabraTrabajo = tipoTrabajo === 'volantes' ? 'Volantes' : 'Impresiones';
                const ladosTexto = colorReverso === 'ninguno'
                    ? 'Frente: ' + colorFrente.replace(/-/g, ' ')
                    : 'Frente: ' + colorFrente.replace(/-/g, ' ') + ' | Reverso: ' + colorReverso.replace(/-/g, ' ');
                var resumenSimplificado = cantidad + ' ' + palabraTrabajo + ' tamano ' + medidaTexto + ' en ' + papelNombre + ', ' + ladosTexto;
                if (llevaLaminado) resumenSimplificado += ', Laminado: ' + textoLaminado;
                resumenSimplificado += ', ' + disenoNombre + '. Costo Unitario: ' + formatCurrency(costoUnitario) + ', Costo Total: ' + formatCurrency(total) + ', Impresion Digital Laser';
                if (esMaquila) resumenSimplificado += ' (Costo de Maquila)';
                resumenSimplificadoTextoPre.textContent = resumenSimplificado;

                // Advertencia offset
                if (hojasBaseNecesarias >= 350) {
                    advertenciaOffsetDiv.innerHTML = '<span class="icono-advertencia"><i class="bi bi-exclamation-triangle-fill"></i></span> Se recomienda cotizar en offset';
                    advertenciaOffsetDiv.style.display = 'block';
                } else {
                    advertenciaOffsetDiv.style.display = 'none';
                }
            }

            function limpiarCampos() {
                form.reset();
                resultadoDiv.style.display = 'none';
                advertenciaOffsetDiv.style.display = 'none';
                document.getElementById('tamanoAutoSeleccionado').textContent = '';
                document.getElementById('opcionesLaminado').style.display = 'none';
                actualizarModoTamano();
                actualizarOpcionesPapel('carta');
            }

            function copiarAlPortapapeles() {
                const texto = resumenSimplificadoTextoPre.textContent;
                navigator.clipboard.writeText(texto).then(function () {
                    alert('Resumen copiado al portapapeles!');
                }, function () { alert('Error al copiar el texto.'); });
            }

            form.addEventListener('submit', function (e) { e.preventDefault(); calcularCosto(); });
            tamanoSelect.addEventListener('change', function () { actualizarOpcionesPapel(tamanoSelect.value); });
            limpiarCamposBtn.addEventListener('click', limpiarCampos);
            copiarPortapapelesBtn.addEventListener('click', copiarAlPortapapeles);

            // Inicializar
            actualizarOpcionesPapel('carta');
        });
    </script>



    <!-- Botón Flotante de Regreso al Menú -->
    <a href="index.html" class="btn-home-flotante" title="Volver al Menú Principal">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        <span>Volver al Menú</span>
    </a>

    <style>
        .btn-home-flotante {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 9999;
            font-family: 'Poppins', 'Inter', sans-serif;
        }

        .btn-home-flotante:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .btn-home-flotante:active {
            transform: translateY(-1px) scale(1.02);
        }

        .btn-home-flotante svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .btn-home-flotante span {
            white-space: nowrap;
        }

        /* Responsive: en móviles solo mostrar el icono */
        @media (max-width: 768px) {
            .btn-home-flotante {
                padding: 15px;
                border-radius: 50%;
                bottom: 20px;
                right: 20px;
            }

            .btn-home-flotante span {
                display: none;
            }

            .btn-home-flotante svg {
                width: 24px;
                height: 24px;
            }
        }
    </style>
</body>

</html>