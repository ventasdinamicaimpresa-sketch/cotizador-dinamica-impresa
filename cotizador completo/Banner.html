<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador de Banners</title>
    <style>
        /*!
 * Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2023 Fonticons, Inc.
 */
        .fa {
            font-family: var(--fa-style-family, "Font Awesome 6 Free");
            font-weight: var(--fa-style, 900)
        }

        .fa,
        .fa-brands,
        .fa-classic,
        .fa-regular,
        .fa-sharp,
        .fa-solid,
        .fab,
        .far,
        .fas {
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased;
            display: var(--fa-display, inline-block);
            font-style: normal;
            font-variant: normal;
            line-height: 1;
            text-rendering: auto
        }

        .fa-classic,
        .fa-regular,
        .fa-solid,
        .far,
        .fas {
            font-family: "Font Awesome 6 Free"
        }

        .fa-brands,
        .fab {
            font-family: "Font Awesome 6 Brands"
        }

        .fa-1x {
            font-size: 1em
        }

        .fa-2x {
            font-size: 2em
        }

        .fa-3x {
            font-size: 3em
        }

        .fa-4x {
            font-size: 4em
        }

        .fa-5x {
            font-size: 5em
        }

        .fa-6x {
            font-size: 6em
        }

        .fa-7x {
            font-size: 7em
        }

        .fa-8x {
            font-size: 8em
        }

        .fa-9x {
            font-size: 9em
        }

        .fa-10x {
            font-size: 10em
        }

        .fa-2xs {
            font-size: .625em;
            line-height: .1em;
            vertical-align: .225em
        }

        .fa-xs {
            font-size: .75em;
            line-height: .08333em;
            vertical-align: .125em
        }

        .fa-sm {
            font-size: .875em;
            line-height: .07143em;
            vertical-align: .05357em
        }

        .fa-lg {
            font-size: 1.25em;
            line-height: .05em;
            vertical-align: -.075em
        }

        .fa-xl {
            font-size: 1.5em;
            line-height: .04167em;
            vertical-align: -.125em
        }

        .fa-2xl {
            font-size: 2em;
            line-height: .03125em;
            vertical-align: -.1875em
        }

        .fa-fw {
            text-align: center;
            width: 1.25em
        }

        .fa-ul {
            list-style-type: none;
            margin-left: var(--fa-li-margin, 2.5em);
            padding-left: 0
        }

        .fa-ul>li {
            position: relative
        }

        .fa-li {
            left: calc(var(--fa-li-width, 2em)*-1);
            position: absolute;
            text-align: center;
            width: var(--fa-li-width, 2em);
            line-height: inherit
        }

        .fa-border {
            border-radius: var(--fa-border-radius, .1em);
            border: var(--fa-border-width, .08em) var(--fa-border-style, solid) var(--fa-border-color, #eee);
            padding: var(--fa-border-padding, .2em .25em .15em)
        }

        .fa-pull-left {
            float: left;
            margin-right: var(--fa-pull-margin, .3em)
        }

        .fa-pull-right {
            float: right;
            margin-left: var(--fa-pull-margin, .3em)
        }

        .fa-beat {
            -webkit-animation-name: fa-beat;
            animation-name: fa-beat;
            -webkit-animation-delay: var(--fa-animation-delay, 0s);
            animation-delay: var(--fa-animation-delay, 0s);
            -webkit-animation-direction: var(--fa-animation-direction, normal);
            animation-direction: var(--fa-animation-direction, normal);
            -webkit-animation-duration: var(--fa-animation-duration, 1s);
            animation-duration: var(--fa-animation-duration, 1s);
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
            animation-timing-function: var(--fa-animation-timing, ease-in-out)
        }

        .fa-bounce {
            -webkit-animation-name: fa-bounce;
            animation-name: fa-bounce;
            -webkit-animation-delay: var(--fa-animation-delay, 0s);
            animation-delay: var(--fa-animation-delay, 0s);
            -webkit-animation-direction: var(--fa-animation-direction, normal);
            animation-direction: var(--fa-animation-direction, normal);
            -webkit-animation-duration: var(--fa-animation-duration, 1s);
            animation-duration: var(--fa-animation-duration, 1s);
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(.28, .84, .42, 1));
            animation-timing-function: var(--fa-animation-timing, cubic-bezier(.28, .84, .42, 1))
        }

        .fa-fade {
            -webkit-animation-name: fa-fade;
            animation-name: fa-fade;
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(.4, 0, .6, 1));
            animation-timing-function: var(--fa-animation-timing, cubic-bezier(.4, 0, .6, 1))
        }

        .fa-beat-fade,
        .fa-fade {
            -webkit-animation-delay: var(--fa-animation-delay, 0s);
            animation-delay: var(--fa-animation-delay, 0s);
            -webkit-animation-direction: var(--fa-animation-direction, normal);
            animation-direction: var(--fa-animation-direction, normal);
            -webkit-animation-duration: var(--fa-animation-duration, 1s);
            animation-duration: var(--fa-animation-duration, 1s)
        }

        .fa-beat-fade {
            -webkit-animation-name: fa-beat-fade;
            animation-name: fa-beat-fade;
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(.4, 0, .6, 1));
            animation-timing-function: var(--fa-animation-timing, cubic-bezier(.4, 0, .6, 1))
        }

        .fa-flip {
            -webkit-animation-name: fa-flip;
            animation-name: fa-flip;
            -webkit-animation-delay: var(--fa-animation-delay, 0s);
            animation-delay: var(--fa-animation-delay, 0s);
            -webkit-animation-direction: var(--fa-animation-direction, normal);
            animation-direction: var(--fa-animation-direction, normal);
            -webkit-animation-duration: var(--fa-animation-duration, 1s);
            animation-duration: var(--fa-animation-duration, 1s);
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
            animation-timing-function: var(--fa-animation-timing, ease-in-out)
        }

        .fa-shake {
            -webkit-animation-name: fa-shake;
            animation-name: fa-shake;
            -webkit-animation-duration: var(--fa-animation-duration, 1s);
            animation-duration: var(--fa-animation-duration, 1s);
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, linear);
            animation-timing-function: var(--fa-animation-timing, linear)
        }

        .fa-shake,
        .fa-spin {
            -webkit-animation-delay: var(--fa-animation-delay, 0s);
            animation-delay: var(--fa-animation-delay, 0s);
            -webkit-animation-direction: var(--fa-animation-direction, normal);
            animation-direction: var(--fa-animation-direction, normal)
        }

        .fa-spin {
            -webkit-animation-name: fa-spin;
            animation-name: fa-spin;
            -webkit-animation-duration: var(--fa-animation-duration, 2s);
            animation-duration: var(--fa-animation-duration, 2s);
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, linear);
            animation-timing-function: var(--fa-animation-timing, linear)
        }

        .fa-spin-reverse {
            --fa-animation-direction: reverse
        }

        .fa-pulse,
        .fa-spin-pulse {
            -webkit-animation-name: fa-spin;
            animation-name: fa-spin;
            -webkit-animation-direction: var(--fa-animation-direction, normal);
            animation-direction: var(--fa-animation-direction, normal);
            -webkit-animation-duration: var(--fa-animation-duration, 1s);
            animation-duration: var(--fa-animation-duration, 1s);
            -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            animation-iteration-count: var(--fa-animation-iteration-count, infinite);
            -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
            animation-timing-function: var(--fa-animation-timing, steps(8))
        }

        @media (prefers-reduced-motion:reduce) {

            .fa-beat,
            .fa-beat-fade,
            .fa-bounce,
            .fa-fade,
            .fa-flip,
            .fa-pulse,
            .fa-shake,
            .fa-spin,
            .fa-spin-pulse {
                -webkit-animation-delay: -1ms;
                animation-delay: -1ms;
                -webkit-animation-duration: 1ms;
                animation-duration: 1ms;
                -webkit-animation-iteration-count: 1;
                animation-iteration-count: 1;
                -webkit-transition-delay: 0s;
                transition-delay: 0s;
                -webkit-transition-duration: 0s;
                transition-duration: 0s
            }
        }

        @-webkit-keyframes fa-beat {

            0%,
            90% {
                -webkit-transform: scale(1);
                transform: scale(1)
            }

            45% {
                -webkit-transform: scale(var(--fa-beat-scale, 1.25));
                transform: scale(var(--fa-beat-scale, 1.25))
            }
        }

        @keyframes fa-beat {

            0%,
            90% {
                -webkit-transform: scale(1);
                transform: scale(1)
            }

            45% {
                -webkit-transform: scale(var(--fa-beat-scale, 1.25));
                transform: scale(var(--fa-beat-scale, 1.25))
            }
        }

        @-webkit-keyframes fa-bounce {
            0% {
                -webkit-transform: scale(1) translateY(0);
                transform: scale(1) translateY(0)
            }

            10% {
                -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, .9)) translateY(0);
                transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, .9)) translateY(0)
            }

            30% {
                -webkit-transform: scale(var(--fa-bounce-jump-scale-x, .9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -.5em));
                transform: scale(var(--fa-bounce-jump-scale-x, .9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -.5em))
            }

            50% {
                -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, .95)) translateY(0);
                transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, .95)) translateY(0)
            }

            57% {
                -webkit-transform: scale(1) translateY(var(--fa-bounce-rebound, -.125em));
                transform: scale(1) translateY(var(--fa-bounce-rebound, -.125em))
            }

            64% {
                -webkit-transform: scale(1) translateY(0);
                transform: scale(1) translateY(0)
            }

            to {
                -webkit-transform: scale(1) translateY(0);
                transform: scale(1) translateY(0)
            }
        }

        @keyframes fa-bounce {
            0% {
                -webkit-transform: scale(1) translateY(0);
                transform: scale(1) translateY(0)
            }

            10% {
                -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, .9)) translateY(0);
                transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, .9)) translateY(0)
            }

            30% {
                -webkit-transform: scale(var(--fa-bounce-jump-scale-x, .9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -.5em));
                transform: scale(var(--fa-bounce-jump-scale-x, .9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -.5em))
            }

            50% {
                -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, .95)) translateY(0);
                transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, .95)) translateY(0)
            }

            57% {
                -webkit-transform: scale(1) translateY(var(--fa-bounce-rebound, -.125em));
                transform: scale(1) translateY(var(--fa-bounce-rebound, -.125em))
            }

            64% {
                -webkit-transform: scale(1) translateY(0);
                transform: scale(1) translateY(0)
            }

            to {
                -webkit-transform: scale(1) translateY(0);
                transform: scale(1) translateY(0)
            }
        }

        @-webkit-keyframes fa-fade {
            50% {
                opacity: var(--fa-fade-opacity, .4)
            }
        }

        @keyframes fa-fade {
            50% {
                opacity: var(--fa-fade-opacity, .4)
            }
        }

        @-webkit-keyframes fa-beat-fade {

            0%,
            to {
                opacity: var(--fa-beat-fade-opacity, .4);
                -webkit-transform: scale(1);
                transform: scale(1)
            }

            50% {
                opacity: 1;
                -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
                transform: scale(var(--fa-beat-fade-scale, 1.125))
            }
        }

        @keyframes fa-beat-fade {

            0%,
            to {
                opacity: var(--fa-beat-fade-opacity, .4);
                -webkit-transform: scale(1);
                transform: scale(1)
            }

            50% {
                opacity: 1;
                -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
                transform: scale(var(--fa-beat-fade-scale, 1.125))
            }
        }

        @-webkit-keyframes fa-flip {
            50% {
                -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
                transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg))
            }
        }

        @keyframes fa-flip {
            50% {
                -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
                transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg))
            }
        }

        @-webkit-keyframes fa-shake {
            0% {
                -webkit-transform: rotate(-15deg);
                transform: rotate(-15deg)
            }

            4% {
                -webkit-transform: rotate(15deg);
                transform: rotate(15deg)
            }

            8%,
            24% {
                -webkit-transform: rotate(-18deg);
                transform: rotate(-18deg)
            }

            12%,
            28% {
                -webkit-transform: rotate(18deg);
                transform: rotate(18deg)
            }

            16% {
                -webkit-transform: rotate(-22deg);
                transform: rotate(-22deg)
            }

            20% {
                -webkit-transform: rotate(22deg);
                transform: rotate(22deg)
            }

            32% {
                -webkit-transform: rotate(-12deg);
                transform: rotate(-12deg)
            }

            36% {
                -webkit-transform: rotate(12deg);
                transform: rotate(12deg)
            }

            40%,
            to {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }
        }

        @keyframes fa-shake {
            0% {
                -webkit-transform: rotate(-15deg);
                transform: rotate(-15deg)
            }

            4% {
                -webkit-transform: rotate(15deg);
                transform: rotate(15deg)
            }

            8%,
            24% {
                -webkit-transform: rotate(-18deg);
                transform: rotate(-18deg)
            }

            12%,
            28% {
                -webkit-transform: rotate(18deg);
                transform: rotate(18deg)
            }

            16% {
                -webkit-transform: rotate(-22deg);
                transform: rotate(-22deg)
            }

            20% {
                -webkit-transform: rotate(22deg);
                transform: rotate(22deg)
            }

            32% {
                -webkit-transform: rotate(-12deg);
                transform: rotate(-12deg)
            }

            36% {
                -webkit-transform: rotate(12deg);
                transform: rotate(12deg)
            }

            40%,
            to {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }
        }

        @-webkit-keyframes fa-spin {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }

            to {
                -webkit-transform: rotate(1turn);
                transform: rotate(1turn)
            }
        }

        @keyframes fa-spin {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }

            to {
                -webkit-transform: rotate(1turn);
                transform: rotate(1turn)
            }
        }

        .fa-rotate-90 {
            -webkit-transform: rotate(90deg);
            transform: rotate(90deg)
        }

        .fa-rotate-180 {
            -webkit-transform: rotate(180deg);
            transform: rotate(180deg)
        }

        .fa-rotate-270 {
            -webkit-transform: rotate(270deg);
            transform: rotate(270deg)
        }

        .fa-flip-horizontal {
            -webkit-transform: scaleX(-1);
            transform: scaleX(-1)
        }

        .fa-flip-vertical {
            -webkit-transform: scaleY(-1);
            transform: scaleY(-1)
        }

        .fa-flip-both,
        .fa-flip-horizontal.fa-flip-vertical {
            -webkit-transform: scale(-1);
            transform: scale(-1)
        }

        .fa-rotate-by {
            -webkit-transform: rotate(var(--fa-rotate-angle, none));
            transform: rotate(var(--fa-rotate-angle, none))
        }

        .fa-stack {
            display: inline-block;
            height: 2em;
            line-height: 2em;
            position: relative;
            vertical-align: middle;
            width: 2.5em
        }

        .fa-stack-1x,
        .fa-stack-2x {
            left: 0;
            position: absolute;
            text-align: center;
            width: 100%;
            z-index: var(--fa-stack-z-index, auto)
        }

        .fa-stack-1x {
            line-height: inherit
        }

        .fa-stack-2x {
            font-size: 2em
        }

        .fa-inverse {
            color: var(--fa-inverse, #fff)
        }
    </style>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --background-color: #f0f2f5;
            --text-color: #333;
            --input-bg-color: #fff;
            --input-border-color: #ced4da;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
        }

        .main-wrapper {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            max-width: 1200px;
            margin: auto;
            padding: 20px;
        }

        .container {
            flex-grow: 1;
            max-width: 800px;
            margin: 0;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px var(--shadow-color);
        }

        #product-image-container {
            flex-shrink: 0;
            width: 350px;
            position: sticky;
            top: 20px;
            display: none;
            /* Hidden by default */
        }

        #product-image {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 4px 20px var(--shadow-color);
            transition: width 0.3s ease;
            /* Optional: smooth transition */
        }

        #product-image.half-size {
            width: 50%;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        /* Media query to hide on small screens */
        @media (max-width: 1100px) {
            .main-wrapper {
                padding: 0;
            }

            #product-image-container {
                display: none;
            }

            .container {
                margin: auto;
                /* Center it again on small screens */
            }
        }

        h1 {
            text-align: center;
            color: var(--dark-color);
            font-weight: 600;
            margin-bottom: 5px;
        }

        h1 .fas {
            margin-right: 10px;
            color: var(--primary-color);
        }

        .subtitle {
            text-align: center;
            margin-top: -20px;
            margin-bottom: 20px;
            color: var(--secondary-color);
            font-size: 0.9em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        label .fas {
            margin-right: 8px;
            color: var(--primary-color);
            width: 20px;
            text-align: center;
        }

        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .radio-group input[type="radio"] {
            display: none;
        }

        .radio-group label {
            display: inline-block;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 25px;
            border: 2px solid var(--input-border-color);
            transition: all 0.3s ease;
            font-weight: 400;
        }

        .radio-group input[type="radio"]:checked+label {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--input-border-color);
            border-radius: 8px;
            background-color: var(--input-bg-color);
            color: var(--text-color);
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: 'Poppins', sans-serif;
        }

        button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            border: none;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-principal {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-rojo {
            background-color: var(--danger-color);
            color: white;
        }

        #copiar-btn,
        #limpiar-todo-btn {
            margin-top: 10px;
        }

        #cotizacion-resumen-container,
        #resumen-container {
            margin-top: 30px;
            padding: 20px;
            background: var(--light-color);
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        #cotizacion-resumen-container h2,
        #resumen-container h2 {
            color: var(--dark-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-top: 0;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        #cotizacion-lista {
            margin-top: 20px;
        }

        .cotizacion-item,
        .item-header {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .cotizacion-item {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            padding: 10px;
            flex-direction: column;
            align-items: stretch;
        }

        .item-descripcion-linea {
            flex-grow: 1;
            font-weight: 500;
        }

        .item-controles {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .item-total-preview {
            font-weight: bold;
            min-width: 80px;
            text-align: right;
        }

        .item-desglose-content {
            padding: 15px;
            border-top: 1px solid #eee;
            margin-top: 10px;
            background: #fdfdfd;
            border-radius: 4px;
        }

        .toggle-desglose-btn {
            width: auto;
            padding: 5px 10px;
            font-size: 0.8em;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 5px;
        }

        .remover-item-btn {
            background: none;
            border: none;
            color: var(--danger-color);
            font-size: 1.4em;
            cursor: pointer;
            padding: 5px;
            width: auto;
        }

        #cotizacion-total-container {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed var(--primary-color);
            text-align: right;
        }

        #cotizacion-total-container h3,
        #cotizacion-total-container h2 {
            margin: 5px 0;
        }

        #cotizacion-total-container h2 {
            font-size: 1.8em;
            color: var(--success-color);
        }

        .costos-materiales-container {
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .collapsible {
            background-color: var(--dark-color);
            color: white;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.2em;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .collapsible:hover {
            background-color: #4a525a;
        }

        .collapsible .fa-chevron-down {
            transition: transform 0.3s ease;
        }

        .collapsible.active .fa-chevron-down {
            transform: rotate(180deg);
        }

        .content-collapsible {
            padding: 0 18px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background-color: #f9f9f9;
            border-radius: 0 0 8px 8px;
            border: 1px solid #eee;
            border-top: none;
        }

        #costos-content {
            padding: 20px 0;
        }

        .costo-seccion {
            margin-bottom: 20px;
        }

        .costo-seccion h3 {
            color: var(--primary-color);
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }

        .costo-tabla {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .costo-tabla th,
        .costo-tabla td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .costo-tabla th {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <div class="main-wrapper">
        <div class="container">
            <h1><i class="fas fa-flag"></i> Cotizador de Banners <i class="fas fa-ad"></i></h1>
            <p class="subtitle">Creado por = Joel Adrian Mtz 8341446103</p>

            <form id="cotizador-form" onsubmit="return false;">
                <div class="form-group">
                    <label for="cantidad"><i class="fas fa-sort-numeric-up"></i> Cantidad:</label>
                    <input type="number" id="cantidad" name="cantidad" min="1" value="1">
                </div>

                <div class="form-group">
                    <label><i class="fas fa-box"></i> Tipo de Producto:</label>
                    <div class="radio-group">
                        <input type="radio" id="tipo-producto-xbanner" name="tipo-producto" value="xbanner">
                        <label for="tipo-producto-xbanner">X-Banner</label>
                        <input type="radio" id="tipo-producto-rollup" name="tipo-producto" value="rollup">
                        <label for="tipo-producto-rollup">Roll Up</label>
                        <input type="radio" id="tipo-producto-demostand" name="tipo-producto" value="demostand">
                        <label for="tipo-producto-demostand">Punto Venta Demo Stand</label>
                    </div>
                </div>

                <div id="opciones-xbanner" style="display: none;">
                    <div class="form-group">
                        <label><i class="fas fa-ruler-combined"></i> Medidas:</label>
                        <div class="radio-group">
                            <input type="radio" id="medida-60x160" name="medida" value="60x160">
                            <label for="medida-60x160">60 x 160 cm</label>
                            <input type="radio" id="medida-80x180" name="medida" value="80x180">
                            <label for="medida-80x180">80 x 180 cm</label>
                            <input type="radio" id="medida-120x200" name="medida" value="120x200">
                            <label for="medida-120x200">120 x 200 cm</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-scroll"></i> ¿Necesitas Lona?</label>
                        <div class="radio-group">
                            <input type="radio" id="lona-si" name="incluir-lona" value="si">
                            <label for="lona-si">Sí</label>
                            <input type="radio" id="lona-no" name="incluir-lona" value="no">
                            <label for="lona-no">No</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-project-diagram"></i> ¿Necesitas Estructura (Banner)?</label>
                        <div class="radio-group">
                            <input type="radio" id="banner-si" name="incluir-banner" value="si">
                            <label for="banner-si">Sí</label>
                            <input type="radio" id="banner-no" name="incluir-banner" value="no">
                            <label for="banner-no">No</label>
                        </div>
                    </div>

                    <div class="form-group" id="existencia-group">
                        <label><i class="fas fa-box-open"></i> ¿Hay en Existencia?</label>
                        <div class="radio-group">
                            <input type="radio" id="existencia-si" name="en-existencia" value="si">
                            <label for="existencia-si">Sí</label>
                            <input type="radio" id="existencia-no" name="en-existencia" value="no">
                            <label for="existencia-no">No</label>
                        </div>
                    </div>
                </div>

                <div id="opciones-rollup" style="display: none;">
                    <div class="form-group">
                        <label><i class="fas fa-cubes"></i> Componentes:</label>
                        <div class="radio-group">
                            <input type="radio" id="rollup-componente-completo" name="rollup-componente"
                                value="completo" checked>
                            <label for="rollup-componente-completo">Completo (Estructura y Lona)</label>
                            <input type="radio" id="rollup-componente-estructura" name="rollup-componente"
                                value="solo_estructura">
                            <label for="rollup-componente-estructura">Solo Estructura</label>
                            <input type="radio" id="rollup-componente-lona" name="rollup-componente" value="solo_lona">
                            <label for="rollup-componente-lona">Solo Lona</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-columns"></i> Tipo de Roll Up:</label>
                        <div class="radio-group">
                            <input type="radio" id="rollup-tipo-1lado" name="rollup-tipo" value="1lado">
                            <label for="rollup-tipo-1lado">Por 1 lado</label>
                            <input type="radio" id="rollup-tipo-doblevista" name="rollup-tipo" value="doblevista">
                            <label for="rollup-tipo-doblevista">Doble Vista</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="rollup-medida"><i class="fas fa-ruler-combined"></i> Medidas para Roll Up:</label>
                        <select id="rollup-medida" name="rollup-medida">
                            <!-- Opciones se llenarán dinámicamente -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-box-open"></i> ¿Hay en Existencia?</label>
                        <div class="radio-group">
                            <input type="radio" id="existencia-rollup-si" name="en-existencia-rollup" value="si">
                            <label for="existencia-rollup-si">Sí</label>
                            <input type="radio" id="existencia-rollup-no" name="en-existencia-rollup" value="no">
                            <label for="existencia-rollup-no">No</label>
                        </div>
                    </div>
                </div>
                <div id="opciones-demostand" style="display: none;">
                    <div class="form-group">
                        <label><i class="fas fa-ruler-combined"></i> Medidas:</label>
                        <p>80 x 180 cm (medida única)</p>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-paint-roller"></i> ¿Rotulado con Vinil Impreso?</label>
                        <div class="radio-group">
                            <input type="radio" id="rotulado-si" name="incluir-rotulado" value="si">
                            <label for="rotulado-si">Sí</label>
                            <input type="radio" id="rotulado-no" name="incluir-rotulado" value="no">
                            <label for="rotulado-no">No</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-box-open"></i> ¿Hay en Existencia?</label>
                        <div class="radio-group">
                            <input type="radio" id="existencia-demostand-si" name="en-existencia-demostand" value="si">
                            <label for="existencia-demostand-si">Sí</label>
                            <input type="radio" id="existencia-demostand-no" name="en-existencia-demostand" value="no">
                            <label for="existencia-demostand-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="tipo-diseno"><i class="fas fa-palette"></i> Tipo de Diseño:</label>
                    <select id="tipo-diseno" name="tipo-diseno">
                        <option value="cliente">Cliente envia diseño</option>
                        <option value="guardado">Diseño guardado aqui</option>
                        <option value="nuevo">Realizar diseño</option>
                    </select>
                </div>

                <div class="form-group">
                    <button type="button" id="agregar-btn" class="btn-principal"><i class="fas fa-plus"></i> Agregar a
                        la Cotización</button>
                </div>
                <div class="form-group">
                    <button type="button" id="limpiar-btn" class="btn-rojo"><i class="fas fa-trash"></i> Limpiar
                        Formulario</button>
                </div>
            </form>

            <div id="cotizacion-resumen-container">
                <h2><i class="fas fa-shopping-cart"></i> Resumen de Cotización</h2>
                <div id="cotizacion-lista"></div>
                <div id="cotizacion-total-container"></div>
            </div>

            <div id="resumen-container">
                <h2><i class="fas fa-file-invoice-dollar"></i> Resumen General para Copiar</h2>
                <textarea id="resumen-texto" rows="5" readonly></textarea>
                <button type="button" id="copiar-btn"><i class="fas fa-copy"></i> Copiar Resumen</button>
                <button type="button" id="limpiar-todo-btn" class="btn-rojo"><i class="fas fa-trash-alt"></i> Limpiar
                    Cotización</button>
            </div>

            <div class="costos-materiales-container">
                <button type="button" class="collapsible">
                    <i class="fas fa-dollar-sign"></i> Costos de Materiales <i class="fas fa-chevron-down"></i>
                </button>
                <div class="content-collapsible">
                    <div id="costos-content"></div>
                </div>
            </div>

        </div>
        <div id="product-image-container">
            <img id="product-image" src="" alt="Vista previa del producto">
        </div>
    </div>

    <script>
        const preciosData = {
            "preciosLona": {
                "Lona Brillante 13oz": [
                    { "min": 0, "max": 5, "precio": 300 },
                    { "min": 5, "max": 10, "precio": 280 },
                    { "min": 10, "max": 20, "precio": 270 },
                    { "min": 20, "max": 50, "precio": 260 },
                    { "min": 50, "max": null, "precio": 250 }
                ]
            },
            "preciosBanner": {
                "60x160": [
                    { "min": 1, "max": 2, "precio": 130.00 },
                    { "min": 3, "max": 5, "precio": 117.00 },
                    { "min": 6, "max": 10, "precio": 107.25 },
                    { "min": 11, "max": 20, "precio": 97.50 },
                    { "min": 21, "max": null, "precio": 91.00 }
                ],
                "80x180": [
                    { "min": 1, "max": 2, "precio": 150.00 },
                    { "min": 3, "max": 5, "precio": 135.00 },
                    { "min": 6, "max": 10, "precio": 123.75 },
                    { "min": 11, "max": 20, "precio": 112.50 },
                    { "min": 21, "max": null, "precio": 105.00 }
                ],
                "120x200": [
                    { "min": 1, "max": 2, "precio": 270.00 },
                    { "min": 3, "max": 5, "precio": 243.00 },
                    { "min": 6, "max": 10, "precio": 222.75 },
                    { "min": 11, "max": 20, "precio": 202.50 },
                    { "min": 21, "max": null, "precio": 189.00 }
                ]
            },
            "preciosRollup": {
                "1lado": {
                    "80x200": [
                        { "min": 1, "max": 2, "precio": 496.00 }, { "min": 3, "max": 5, "precio": 465.00 }, { "min": 6, "max": 10, "precio": 449.50 }, { "min": 11, "max": 20, "precio": 434.00 }, { "min": 21, "max": null, "precio": 412.30 }
                    ],
                    "85x200": [
                        { "min": 1, "max": 2, "precio": 576.00 }, { "min": 3, "max": 5, "precio": 540.00 }, { "min": 6, "max": 10, "precio": 522.00 }, { "min": 11, "max": 20, "precio": 504.00 }, { "min": 21, "max": null, "precio": 478.80 }
                    ]
                },
                "doblevista": {
                    "85x200": [
                        { "min": 1, "max": 2, "precio": 1408.00 }, { "min": 3, "max": 5, "precio": 1320.00 }, { "min": 6, "max": 10, "precio": 1276.00 }, { "min": 11, "max": 20, "precio": 1232.00 }, { "min": 21, "max": null, "precio": 1170.40 }
                    ],
                    "120x200": [
                        { "min": 1, "max": 2, "precio": 1584.00 }, { "min": 3, "max": 5, "precio": 1485.00 }, { "min": 6, "max": 10, "precio": 1435.50 }, { "min": 11, "max": 20, "precio": 1386.00 }, { "min": 21, "max": null, "precio": 1316.70 }
                    ]
                }
            },
            "preciosDiseno": {
                "cliente": 0,
                "guardado": 50,
                "nuevo": 215.51
            },
            "costoEnvio": 350,
            "preciosInstalacionVinil": [
                { "min": 1, "max": 2, "precio": 180.00 },
                { "min": 3, "max": 5, "precio": 150.00 },
                { "min": 6, "max": 10, "precio": 130.00 },
                { "min": 11, "max": 20, "precio": 110.00 },
                { "min": 21, "max": null, "precio": 85.00 }
            ],
            "preciosDemoStand": {
                "80x180": [
                    { "min": 1, "max": 2, "precio": 1408.00 },
                    { "min": 3, "max": 5, "precio": 1320.00 },
                    { "min": 6, "max": 10, "precio": 1276.00 },
                    { "min": 11, "max": 20, "precio": 1232.00 },
                    { "min": 21, "max": null, "precio": 1170.40 }
                ]
            }
        };

        let cotizacionActual = [];

        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('cotizador-form');
            const resumenTexto = document.getElementById('resumen-texto');
            const cotizacionLista = document.getElementById('cotizacion-lista');
            const cotizacionTotalContainer = document.getElementById('cotizacion-total-container');

            // Product selection elements
            const tipoProductoRadios = form.elements['tipo-producto'];
            const opcionesXBanner = document.getElementById('opciones-xbanner');
            const opcionesRollup = document.getElementById('opciones-rollup');
            const opcionesDemoStand = document.getElementById('opciones-demostand');

            // X-Banner specific elements
            const existenciaGroup = document.getElementById('existencia-group');
            const incluirBannerRadios = form.elements['incluir-banner'];

            // Rollup specific elements
            const rollupTipoRadios = form.elements['rollup-tipo'];
            const rollupMedidaSelect = document.getElementById('rollup-medida');

            const toggleExistenciaGroup = () => {
                if (incluirBannerRadios) {
                    const radioValue = form.elements['incluir-banner'].value;
                    existenciaGroup.style.display = radioValue === 'si' ? 'block' : 'none';
                }
            };

            if (incluirBannerRadios) {
                Array.from(incluirBannerRadios).forEach(radio => radio.addEventListener('change', toggleExistenciaGroup));
            }

            const toggleProductOptions = () => {
                const selectedProduct = form.elements['tipo-producto'].value;
                opcionesXBanner.style.display = 'none';
                opcionesRollup.style.display = 'none';
                opcionesDemoStand.style.display = 'none';

                const imageContainer = document.getElementById('product-image-container');
                const imageEl = document.getElementById('product-image');
                const images = {
                    xbanner: 'BANNER%20.jpg',
                    rollup: 'ROLL%20UP%20.jpg',
                    demostand: 'PUNTO%20DE%20VENTA%20STAND%20.jpg'
                };

                if (imageContainer) {
                    imageContainer.style.display = 'none';
                    imageEl.classList.remove('half-size'); // Reset class by default
                }

                if (selectedProduct === 'xbanner') {
                    opcionesXBanner.style.display = 'block';
                    if (imageContainer) {
                        imageEl.src = images.xbanner;
                        imageContainer.style.display = 'block';
                    }
                } else if (selectedProduct === 'rollup') {
                    opcionesRollup.style.display = 'block';
                    if (imageContainer) {
                        imageEl.src = images.rollup;
                        imageContainer.style.display = 'block';
                    }
                } else if (selectedProduct === 'demostand') {
                    opcionesDemoStand.style.display = 'block';
                    if (imageContainer) {
                        imageEl.src = images.demostand;
                        imageEl.classList.add('half-size'); // Apply special class
                        imageContainer.style.display = 'block';
                    }
                }
            };

            Array.from(tipoProductoRadios).forEach(radio => radio.addEventListener('change', toggleProductOptions));

            const updateRollupMedidas = () => {
                const selectedTipo = form.elements['rollup-tipo'].value;
                rollupMedidaSelect.innerHTML = ''; // Clear existing options
                if (selectedTipo && preciosData.preciosRollup[selectedTipo]) {
                    const medidas = Object.keys(preciosData.preciosRollup[selectedTipo]);
                    medidas.forEach(medida => {
                        const option = document.createElement('option');
                        option.value = medida;
                        option.textContent = medida.replace('x', ' x ') + ' cm';
                        rollupMedidaSelect.appendChild(option);
                    });
                }
            };

            Array.from(rollupTipoRadios).forEach(radio => radio.addEventListener('change', updateRollupMedidas));

            const getFormInputs = () => {
                const medidaRadio = form.querySelector('input[name="medida"]:checked');
                const lonaRadio = form.querySelector('input[name="incluir-lona"]:checked');
                const bannerRadio = form.querySelector('input[name="incluir-banner"]:checked');
                const existenciaRadio = form.querySelector('input[name="en-existencia"]:checked');
                const rollupTipoRadio = form.querySelector('input[name="rollup-tipo"]:checked');
                const existenciaRollupRadio = form.querySelector('input[name="en-existencia-rollup"]:checked');
                const rotuladoRadio = form.querySelector('input[name="incluir-rotulado"]:checked');
                const existenciaDemoStandRadio = form.querySelector('input[name="en-existencia-demostand"]:checked');
                const rollupComponenteRadio = form.querySelector('input[name="rollup-componente"]:checked');

                return {
                    producto: form.elements['tipo-producto'].value,
                    cantidad: parseInt(document.getElementById('cantidad').value) || 1,
                    tipoDiseno: document.getElementById('tipo-diseno').value,
                    // X-Banner
                    medida: medidaRadio ? medidaRadio.value : null,
                    incluirLona: lonaRadio ? lonaRadio.value === 'si' : false,
                    incluirBanner: bannerRadio ? bannerRadio.value === 'si' : false,
                    enExistencia: existenciaRadio ? existenciaRadio.value === 'si' : false,
                    // Roll Up
                    rollupTipo: rollupTipoRadio ? rollupTipoRadio.value : null,
                    rollupMedida: rollupMedidaSelect.value,
                    enExistenciaRollup: existenciaRollupRadio ? existenciaRollupRadio.value === 'si' : false,
                    rollupComponente: rollupComponenteRadio ? rollupComponenteRadio.value : 'completo',
                    // Demo Stand
                    incluirRotulado: rotuladoRadio ? rotuladoRadio.value === 'si' : false,
                    enExistenciaDemoStand: existenciaDemoStandRadio ? existenciaDemoStandRadio.value === 'si' : false,
                }
            };

            const encontrarPrecio = (precios, cantidad) => precios.find(p => cantidad >= p.min && (p.max === null || cantidad <= p.max));

            const getCostoDiseno = (tipoDiseno) => {
                const costo = preciosData.preciosDiseno?.[tipoDiseno] || 0;
                const texto = document.querySelector(`#tipo-diseno option[value="${tipoDiseno}"]`)?.textContent || tipoDiseno;
                return { costo, texto };
            };

            const calcularItem = () => {
                const inputs = getFormInputs();
                if (!inputs.producto) {
                    alert("Por favor, seleccione un tipo de producto.");
                    return null;
                }

                if (inputs.producto === 'xbanner') {
                    return calcularXBanner(inputs);
                }
                if (inputs.producto === 'rollup') {
                    return calcularRollup(inputs);
                }
                if (inputs.producto === 'demostand') {
                    return calcularDemoStand(inputs);
                }
                alert("La cotización para este producto aún no está implementada.");
                return null;
            };

            const calcularXBanner = (inputs) => {
                if (!inputs.medida) {
                    alert("Por favor, seleccione una medida para el X-Banner.");
                    return null;
                }
                if (!inputs.incluirLona && !inputs.incluirBanner) {
                    alert("Debes seleccionar al menos la lona o la estructura del banner.");
                    return null;
                }

                let costoLona = 0, costoBanner = 0, costoEnvio = 0, areaTotal = 0;
                let desgloseHTML = '<p><strong>Detalles del Artículo:</strong></p><ul>';

                const [anchoCm, largoCm] = inputs.medida.split('x').map(Number);
                const [anchoM, largoM] = [anchoCm / 100, largoCm / 100];

                if (inputs.incluirLona) {
                    const material = "Lona Brillante 13oz";
                    areaTotal = (anchoM * largoM) * inputs.cantidad;
                    const areaCalc = Math.max(1, areaTotal);
                    const tierLona = encontrarPrecio(preciosData.preciosLona[material], areaTotal);
                    if (!tierLona) {
                        alert(`No se encontró rango de precio para ${areaTotal.toFixed(2)} m² de lona.`);
                        return null;
                    }
                    costoLona = tierLona.precio * areaCalc;
                    if (areaCalc === 1 && areaTotal < 1) {
                        desgloseHTML += `<li><strong style="color:var(--danger-color);">Nota Lona: Se cobra mínimo 1 m² (real: ${areaTotal.toFixed(3)} m²).</strong></li>`;
                    }
                    desgloseHTML += `<li>Costo Lona (${areaCalc.toFixed(2)} m² @ $${tierLona.precio.toFixed(2)}/m²): $${costoLona.toFixed(2)}</li>`;
                }

                if (inputs.incluirBanner) {
                    const preciosEstructura = preciosData.preciosBanner[inputs.medida];
                    const tierEstructura = encontrarPrecio(preciosEstructura, inputs.cantidad);
                    if (!tierEstructura) {
                        alert(`No se encontró rango de precio para ${inputs.cantidad} estructuras.`);
                        return null;
                    }
                    costoBanner = tierEstructura.precio * inputs.cantidad;
                    desgloseHTML += `<li>Costo Estructura (${inputs.medida} cm) x${inputs.cantidad} (@ $${tierEstructura.precio.toFixed(2)}/u): $${costoBanner.toFixed(2)}</li>`;

                    if (!inputs.enExistencia) {
                        costoEnvio = preciosData.costoEnvio;
                        desgloseHTML += `<li>Costo Envío (sin stock): $${costoEnvio.toFixed(2)}</li>`;
                    }
                }

                const { costo: costoDiseno, texto: textoDiseno } = getCostoDiseno(inputs.tipoDiseno);
                if (costoDiseno > 0) {
                    desgloseHTML += `<li>Costo Diseño (${textoDiseno}): $${costoDiseno.toFixed(2)}</li>`;
                }

                const subtotal = costoLona + costoBanner + costoDiseno + costoEnvio;
                const total = subtotal * 1.16;

                let desc = '';
                if (inputs.incluirLona && inputs.incluirBanner) {
                    desc = 'Banner con Porta X-Banner Reforzado';
                } else if (inputs.incluirLona) {
                    desc = 'Banner (Lona)';
                } else {
                    desc = 'Porta X-Banner Reforzado';
                }

                if (inputs.incluirLona) {
                    desc += ' Impresa Alta Resolucion';
                }

                const descripcion = `${inputs.cantidad}pz de ${desc} ${inputs.medida} cm`;

                desgloseHTML += `</ul><p style="margin-top:10px;">Subtotal: $${subtotal.toFixed(2)}</p><p>IVA (16%): $${(subtotal * 0.16).toFixed(2)}</p><h4 style="margin-top:5px;">Total Artículo: $${total.toFixed(2)}</h4>`;

                return {
                    id: Date.now(),
                    descripcion, total, desgloseHTML,
                    datos: { ...inputs, areaTotal, costoLona, costoBanner, costoDiseno, costoEnvio, subtotal, materialImpresion: "Lona Brillante 13oz" }
                };
            };

            const calcularRollup = (inputs) => {
                if (!inputs.rollupTipo || !inputs.rollupMedida) {
                    alert("Por favor, seleccione el tipo y la medida para el Roll Up.");
                    return null;
                }

                // --- Universal Price & Cost Calculation ---
                const preciosVenta = preciosData.preciosRollup[inputs.rollupTipo][inputs.rollupMedida];
                const tierVenta = encontrarPrecio(preciosVenta, inputs.cantidad);
                if (!tierVenta) {
                    alert(`No se encontró rango de precio para ${inputs.cantidad} Roll Ups.`);
                    return null;
                }
                const precioUnitarioVentaRollupCompleto = tierVenta.precio;

                const costosBaseRollup = {
                    "1lado": { "80x200": 310, "85x200": 360 },
                    "doblevista": { "85x200": 900, "120x200": 1000 }
                };
                const costoBaseEstructuraUnitario = costosBaseRollup[inputs.rollupTipo][inputs.rollupMedida];

                const [anchoCm, largoCm] = inputs.rollupMedida.split('x').map(Number);
                const [anchoM, largoM] = [anchoCm / 100, largoCm / 100];
                const numLonasPorRollup = inputs.rollupTipo === 'doblevista' ? 2 : 1;
                const areaLonaUnitario = anchoM * largoM;

                const areaTotalLona = areaLonaUnitario * numLonasPorRollup * inputs.cantidad;
                const areaCalcLona = Math.max(1, areaTotalLona);
                const tierLona = encontrarPrecio(preciosData.preciosLona["Lona Brillante 13oz"], areaTotalLona);
                if (!tierLona) {
                    alert(`No se encontró rango de precio para ${areaTotalLona.toFixed(2)} m² de lona.`);
                    return null;
                }
                const costoLonaPorM2 = tierLona.precio;
                const costoLonaTotal = costoLonaPorM2 * areaCalcLona;
                const costoBaseLonaUnitario = costoLonaTotal / inputs.cantidad;

                const totalCostoBase = costoBaseEstructuraUnitario + costoBaseLonaUnitario;
                const margenTotal = precioUnitarioVentaRollupCompleto - totalCostoBase;

                const proporcionLona = totalCostoBase > 0 ? costoBaseLonaUnitario / totalCostoBase : 0;
                const proporcionEstructura = totalCostoBase > 0 ? costoBaseEstructuraUnitario / totalCostoBase : 0;

                const precioVentaLonaUnitario = costoBaseLonaUnitario + (margenTotal * proporcionLona);
                const precioVentaEstructuraUnitario = costoBaseEstructuraUnitario + (margenTotal * proporcionEstructura);
                // --- End Universal Price & Cost Calculation ---

                let subtotal = 0;
                let descripcion = "";
                let desgloseHTML = "<p><strong>Detalles del Artículo:</strong></p><ul>";

                const { costo: costoDiseno, texto: textoDiseno } = getCostoDiseno(inputs.tipoDiseno);
                let costoEnvio = 0;

                const tipoTexto = inputs.rollupTipo === '1lado' ? '1 Lado' : 'Doble Vista';
                const medidaTexto = `${inputs.rollupMedida.replace('x', ' x ')} cm`;

                if (inputs.rollupComponente === 'completo') {
                    subtotal = precioUnitarioVentaRollupCompleto * inputs.cantidad;
                    descripcion = `${inputs.cantidad}pz de Roll Up Completo ${tipoTexto} ${medidaTexto}`;
                    desgloseHTML += `<li>Precio Estructura: $${(precioVentaEstructuraUnitario * inputs.cantidad).toFixed(2)} (${inputs.cantidad} x $${precioVentaEstructuraUnitario.toFixed(2)})</li>`;
                    desgloseHTML += `<li>Precio Lona: $${(precioVentaLonaUnitario * inputs.cantidad).toFixed(2)} (${inputs.cantidad} x $${precioVentaLonaUnitario.toFixed(2)})</li>`;

                    if (costoDiseno > 0) {
                        subtotal += costoDiseno;
                        desgloseHTML += `<li>Costo Diseño (${textoDiseno}): $${costoDiseno.toFixed(2)}</li>`;
                    }
                    if (!inputs.enExistenciaRollup) {
                        costoEnvio = preciosData.costoEnvio;
                        subtotal += costoEnvio;
                        desgloseHTML += `<li>Costo Envío (sin stock): $${costoEnvio.toFixed(2)}</li>`;
                    }

                } else if (inputs.rollupComponente === 'solo_estructura') {
                    subtotal = precioVentaEstructuraUnitario * inputs.cantidad;
                    descripcion = `${inputs.cantidad}pz de Solo Estructura Roll Up ${tipoTexto} ${medidaTexto}`;
                    desgloseHTML += `<li>Precio Estructura: $${subtotal.toFixed(2)} (${inputs.cantidad} x $${precioVentaEstructuraUnitario.toFixed(2)})</li>`;

                    if (!inputs.enExistenciaRollup) {
                        costoEnvio = preciosData.costoEnvio;
                        subtotal += costoEnvio;
                        desgloseHTML += `<li>Costo Envío (sin stock): $${costoEnvio.toFixed(2)}</li>`;
                    }

                } else if (inputs.rollupComponente === 'solo_lona') {
                    subtotal = precioVentaLonaUnitario * inputs.cantidad;
                    descripcion = `${inputs.cantidad}pz de Solo Lona para Roll Up ${tipoTexto} ${medidaTexto}`;
                    desgloseHTML += `<li>Precio Lona: $${subtotal.toFixed(2)} (${inputs.cantidad} x $${precioVentaLonaUnitario.toFixed(2)})</li>`;

                    if (costoDiseno > 0) {
                        subtotal += costoDiseno;
                        desgloseHTML += `<li>Costo Diseño (${textoDiseno}): $${costoDiseno.toFixed(2)}</li>`;
                    }
                }

                const total = subtotal * 1.16;
                desgloseHTML += `</ul><p style="margin-top:10px;">Subtotal: $${subtotal.toFixed(2)}</p><p>IVA (16%): $${(subtotal * 0.16).toFixed(2)}</p><h4 style="margin-top:5px;">Total Artículo: $${total.toFixed(2)}</h4>`;

                return {
                    id: Date.now(),
                    descripcion,
                    total,
                    desgloseHTML,
                    datos: { ...inputs, subtotal }
                };
            };

            const calcularDemoStand = (inputs) => {
                const medida = "80x180";

                // Costo de la estructura base (precio de venta sin rotular)
                const preciosEstructura = preciosData.preciosDemoStand[medida];
                const tierEstructura = encontrarPrecio(preciosEstructura, inputs.cantidad);
                if (!tierEstructura) {
                    alert(`No se encontró rango de precio para ${inputs.cantidad} Demo Stands.`);
                    return null;
                }
                const costoEstructura = tierEstructura.precio * inputs.cantidad;

                let desgloseHTML = `<p><strong>Detalles del Artículo:</strong></p><ul>`;
                desgloseHTML += `<li>Costo Estructura Demo Stand (${medida} cm) x${inputs.cantidad} (@ $${tierEstructura.precio.toFixed(2)}/u): $${costoEstructura.toFixed(2)}</li>`;

                let costoVinil = 0;
                let costoInstalacion = 0;

                if (inputs.incluirRotulado) {
                    const areaVinilUnitario = 2.25; // 1.5m * 1.5m
                    const areaTotalVinil = areaVinilUnitario * inputs.cantidad;
                    const areaCalcVinil = Math.max(1, areaTotalVinil);

                    // Usando precios de Lona para el Vinil, como se asumió.
                    const materialVinil = "Lona Brillante 13oz";
                    const tierVinil = encontrarPrecio(preciosData.preciosLona[materialVinil], areaTotalVinil);
                    if (!tierVinil) {
                        alert(`No se encontró rango de precio para ${areaTotalVinil.toFixed(2)} m² de vinil.`);
                        return null;
                    }
                    costoVinil = tierVinil.precio * areaCalcVinil;
                    desgloseHTML += `<li>Costo Vinil Impreso (${areaCalcVinil.toFixed(2)} m² @ $${tierVinil.precio.toFixed(2)}/m²): $${costoVinil.toFixed(2)}</li>`;

                    const tierInstalacion = encontrarPrecio(preciosData.preciosInstalacionVinil, inputs.cantidad);
                    if (!tierInstalacion) {
                        alert(`No se encontró rango de precio de instalación para ${inputs.cantidad} unidades.`);
                        return null;
                    }
                    costoInstalacion = tierInstalacion.precio * inputs.cantidad;
                    desgloseHTML += `<li>Costo Instalación Vinil x${inputs.cantidad} (@ $${tierInstalacion.precio.toFixed(2)}/u): $${costoInstalacion.toFixed(2)}</li>`;
                }

                const { costo: costoDiseno, texto: textoDiseno } = getCostoDiseno(inputs.tipoDiseno);
                if (costoDiseno > 0) {
                    desgloseHTML += `<li>Costo Diseño (${textoDiseno}): $${costoDiseno.toFixed(2)}</li>`;
                }

                let costoEnvio = 0;
                if (!inputs.enExistenciaDemoStand) {
                    costoEnvio = preciosData.costoEnvio;
                    desgloseHTML += `<li>Costo Envío (sin stock): $${costoEnvio.toFixed(2)}</li>`;
                }

                const subtotal = costoEstructura + costoVinil + costoInstalacion + costoDiseno + costoEnvio;
                const total = subtotal * 1.16;

                const rotuladoTexto = inputs.incluirRotulado ? "Rotulado con Vinil Impreso en Alta Resolucion" : "sin Rotular";
                const descripcion = `${inputs.cantidad}pz de Punto Venta Demo Stand ${medida} cm ${rotuladoTexto}`;

                desgloseHTML += `</ul><p style="margin-top:10px;">Subtotal: $${subtotal.toFixed(2)}</p><p>IVA (16%): $${(subtotal * 0.16).toFixed(2)}</p><h4 style="margin-top:5px;">Total Artículo: $${total.toFixed(2)}</h4>`;

                return {
                    id: Date.now(),
                    descripcion, total, desgloseHTML,
                    datos: { ...inputs, subtotal }
                };
            };

            const formatNumber = (num) => {
                return num.toLocaleString('es-MX', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
            };

            const renderTotal = () => {
                if (cotizacionActual.length === 0) {
                    cotizacionTotalContainer.innerHTML = '';
                    resumenTexto.value = '';
                    return;
                }

                const subtotalGeneral = cotizacionActual.reduce((sum, item) => sum + item.datos.subtotal, 0);
                const totalGeneral = cotizacionActual.reduce((sum, item) => sum + item.total, 0);
                const ivaFinal = totalGeneral - subtotalGeneral;

                let html = '';
                html += `<h3>Subtotal: $${formatNumber(subtotalGeneral)}</h3>`;
                html += `<h3>IVA (16%): $${formatNumber(ivaFinal)}</h3>`;
                html += `<h2>Total General: $${formatNumber(totalGeneral)}</h2>`;
                cotizacionTotalContainer.innerHTML = html;

                let resumenGeneralTexto = cotizacionActual.map(item => {
                    const precioIndividual = item.total / item.datos.cantidad;
                    let lineText = `- ${item.descripcion} -> $${formatNumber(precioIndividual)} c/u (neto)`;
                    if (item.datos.cantidad > 1) {
                        lineText += `, Total = $${formatNumber(item.total)} neto`;
                    }
                    return lineText;
                }).join('\n');

                if (cotizacionActual.length > 0) {
                    resumenGeneralTexto += `\n--------------------\nTotal General: $${formatNumber(totalGeneral)} (IVA incluido)`;
                }
                resumenTexto.value = resumenGeneralTexto;
            };

            const agregarArticulo = () => {
                const nuevoItem = calcularItem();
                if (nuevoItem) {
                    cotizacionActual.push(nuevoItem);
                    renderCotizacion();
                }
            };

            const removerArticulo = (id) => {
                cotizacionActual = cotizacionActual.filter(item => item.id !== id);
                renderCotizacion();
            };

            const renderCotizacion = () => {
                cotizacionLista.innerHTML = cotizacionActual.length === 0 ? '<p>No hay artículos en la cotización.</p>' : '';
                cotizacionActual.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'cotizacion-item';
                    itemEl.innerHTML = `
                        <div class="item-header">
                            <span class="item-descripcion-linea">${item.descripcion}</span>
                            <div class="item-controles">
                                <strong class="item-total-preview">$${formatNumber(item.total)}</strong>
                                <button class="toggle-desglose-btn" data-id="${item.id}">Desglose</button>
                                <button class="remover-item-btn" data-id="${item.id}"><i class="fas fa-times-circle"></i></button>
                            </div>
                        </div>
                        <div class="item-desglose-content" id="desglose-${item.id}" style="display: none;">${item.desgloseHTML}</div>
                    `;
                    cotizacionLista.appendChild(itemEl);
                });
                renderTotal();
            };

            const limpiarFormulario = () => {
                form.reset();
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.checked = false;
                });
                toggleExistenciaGroup();
                toggleProductOptions();
                updateRollupMedidas();
            };

            form.addEventListener('submit', (e) => e.preventDefault());
            document.getElementById('agregar-btn').addEventListener('click', agregarArticulo);
            document.getElementById('limpiar-btn').addEventListener('click', limpiarFormulario);
            document.getElementById('limpiar-todo-btn').addEventListener('click', () => {
                if (cotizacionActual.length > 0 && confirm('¿Borrar toda la cotización?')) {
                    cotizacionActual = [];
                    renderCotizacion();
                    limpiarFormulario();
                }
            });
            document.getElementById('copiar-btn').addEventListener('click', () => {
                if (resumenTexto.value) navigator.clipboard.writeText(resumenTexto.value).then(() => alert('Resumen copiado'), () => alert('Error al copiar'));
            });

            cotizacionLista.addEventListener('click', (e) => {
                const target = e.target;
                const id = target.dataset.id || target.closest('[data-id]')?.dataset.id;
                if (!id) return;

                if (target.classList.contains('remover-item-btn') || target.closest('.remover-item-btn')) {
                    removerArticulo(parseInt(id));
                }
                if (target.classList.contains('toggle-desglose-btn')) {
                    const content = document.getElementById(`desglose-${id}`);
                    if (content) {
                        const isVisible = content.style.display === 'block';
                        content.style.display = isVisible ? 'none' : 'block';
                        target.textContent = isVisible ? 'Ocultar' : 'Desglose';
                    }
                }
            });

            const popularCostos = () => {
                const costosContainer = document.getElementById('costos-content');
                if (!costosContainer) return;
                let html = '';

                // Lona Prices
                html += '<div class="costo-seccion"><h3>Precios de Lona (Lona Brillante 13oz)</h3>';
                html += '<table class="costo-tabla"><tr><th>Rango (m²)</th><th>Precio por m²</th></tr>';
                preciosData.preciosLona['Lona Brillante 13oz'].forEach(r => {
                    html += `<tr><td>${r.min} - ${r.max || 'adelante'}</td><td>$${formatNumber(r.precio)}</td></tr>`;
                });
                html += '</table></div>';

                // Banner Prices
                html += '<div class="costo-seccion"><h3>Precios de Estructura (Porta X-Banner Reforzado)</h3>';
                const costosBaseBanner = { "60x160": 65.00, "80x180": 75.00, "120x200": 135.00 };
                for (const medida in preciosData.preciosBanner) {
                    html += `<h4>${medida} cm = $${formatNumber(costosBaseBanner[medida])} costo</h4>`;
                    html += '<table class="costo-tabla"><tr><th>Cantidad</th><th>Precio por Unidad</th></tr>';
                    preciosData.preciosBanner[medida].forEach(r => {
                        html += `<tr><td>${r.min} - ${r.max || '+'} pz</td><td>$${formatNumber(r.precio)}</td></tr>`;
                    });
                    html += '</table>';
                }
                html += '</div>';

                // Rollup Prices
                html += '<div class="costo-seccion"><h3>Precios de Venta Roll Up (Estructura + Lona)</h3>';
                const costosBaseRollup = {
                    "1lado": { "80x200": 310, "85x200": 360 },
                    "doblevista": { "85x200": 900, "120x200": 1000 }
                };
                for (const tipo in preciosData.preciosRollup) {
                    const tipoTexto = tipo === '1lado' ? 'Por 1 lado' : 'Doble Vista';
                    html += `<h4>${tipoTexto}</h4>`;
                    for (const medida in preciosData.preciosRollup[tipo]) {
                        html += `<p style="margin-left: 15px;"><b>${medida.replace('x', ' x ')} cm</b> = $${formatNumber(costosBaseRollup[tipo][medida])} costo</p>`;
                        html += '<table class="costo-tabla" style="margin-left: 15px; width: calc(100% - 15px);"><tr><th>Cantidad</th><th>Precio por Unidad</th></tr>';
                        preciosData.preciosRollup[tipo][medida].forEach(r => {
                            html += `<tr><td>${r.min} - ${r.max || '+'} pz</td><td>$${formatNumber(r.precio)}</td></tr>`;
                        });
                        html += '</table>';
                    }
                }
                html += '</div>';

                // Demo Stand Prices
                html += '<div class="costo-seccion"><h3>Precios de Venta Punto Venta Demo Stand (sin rotular)</h3>';
                const costoBaseDemoStand = 760;
                for (const medida in preciosData.preciosDemoStand) {
                    html += `<h4>${medida} cm = $${formatNumber(costoBaseDemoStand)} costo</h4>`;
                    html += '<table class="costo-tabla"><tr><th>Cantidad</th><th>Precio por Unidad</th></tr>';
                    preciosData.preciosDemoStand[medida].forEach(r => {
                        html += `<tr><td>${r.min} - ${r.max || '+'} pz</td><td>$${formatNumber(r.precio)}</td></tr>`;
                    });
                    html += '</table>';
                }
                html += '</div>';

                // Vinyl Installation
                html += '<div class="costo-seccion"><h3>Costo de Instalación de Vinil (en Demo Stand)</h3>';
                html += '<table class="costo-tabla"><tr><th>Cantidad</th><th>Precio por Unidad</th></tr>';
                preciosData.preciosInstalacionVinil.forEach(r => {
                    html += `<tr><td>${r.min} - ${r.max || '+'} pz</td><td>$${formatNumber(r.precio)}</td></tr>`;
                });
                html += '</table></div>';

                // Design Prices
                html += '<div class="costo-seccion"><h3>Precios de Diseño</h3>';
                html += '<table class="costo-tabla"><tr><th>Tipo</th><th>Costo</th></tr>';
                for (const tipo in preciosData.preciosDiseno) {
                    const texto = document.querySelector(`#tipo-diseno option[value="${tipo}"]`)?.textContent || tipo;
                    html += `<tr><td>${texto}</td><td>$${formatNumber(preciosData.preciosDiseno[tipo])}</td></tr>`;
                }
                html += '</table></div>';

                // Shipping Cost
                html += '<div class="costo-seccion"><h3>Costo de Envío (por falta de stock)</h3>';
                html += `<p>$${formatNumber(preciosData.costoEnvio)}</p>`;
                html += '</div>';

                costosContainer.innerHTML = html;
            };

            const collapsibleBtn = document.querySelector('.collapsible');
            const collapsibleContent = document.querySelector('.content-collapsible');

            collapsibleBtn.addEventListener('click', function () {
                this.classList.toggle('active');
                if (collapsibleContent.style.maxHeight) {
                    collapsibleContent.style.maxHeight = null;
                } else {
                    collapsibleContent.style.maxHeight = collapsibleContent.scrollHeight + "px";
                }
            });

            limpiarFormulario();
            popularCostos();
            renderCotizacion();
        });
    </script>

    <!-- Botón Flotante de Regreso al Menú -->
    <a href="indexcotizadorcompleto.html" class="btn-home-flotante" title="Volver al Menú Principal">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        <span>Volver al Menú</span>
    </a>

    <style>
        .btn-home-flotante {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 9999;
            font-family: 'Poppins', 'Inter', sans-serif;
        }

        .btn-home-flotante:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .btn-home-flotante:active {
            transform: translateY(-1px) scale(1.02);
        }

        .btn-home-flotante svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .btn-home-flotante span {
            white-space: nowrap;
        }

        /* Responsive: en móviles solo mostrar el icono */
        @media (max-width: 768px) {
            .btn-home-flotante {
                padding: 15px;
                border-radius: 50%;
                bottom: 20px;
                right: 20px;
            }

            .btn-home-flotante span {
                display: none;
            }

            .btn-home-flotante svg {
                width: 24px;
                height: 24px;
            }
        }
    </style>
</body>

</html>